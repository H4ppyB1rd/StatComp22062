<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="22062" />


<title>homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">homework</h1>
<h4 class="author">22062</h4>
<h4 class="date">2022/11/25</h4>



<div id="overview" class="section level1">
<h1>Overview</h1>
<p>This is my homework for the Statistical Computation course of
2022.</p>
</div>
<div id="hw0" class="section level1">
<h1>HW0</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples(text,figures,tables).</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>text:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>mytext <span class="ot">=</span> <span class="st">&quot;hello R!&quot;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mytext)</span></code></pre></div>
<pre><code>## [1] &quot;hello R!&quot;</code></pre>
<p>figures:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y,<span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>tables:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> state.x77[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(dt)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Population
</th>
<th style="text-align:right;">
Income
</th>
<th style="text-align:right;">
Illiteracy
</th>
<th style="text-align:right;">
Life Exp
</th>
<th style="text-align:right;">
Murder
</th>
<th style="text-align:right;">
HS Grad
</th>
<th style="text-align:right;">
Frost
</th>
<th style="text-align:right;">
Area
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Alabama
</td>
<td style="text-align:right;">
3615
</td>
<td style="text-align:right;">
3624
</td>
<td style="text-align:right;">
2.1
</td>
<td style="text-align:right;">
69.05
</td>
<td style="text-align:right;">
15.1
</td>
<td style="text-align:right;">
41.3
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
50708
</td>
</tr>
<tr>
<td style="text-align:left;">
Alaska
</td>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
6315
</td>
<td style="text-align:right;">
1.5
</td>
<td style="text-align:right;">
69.31
</td>
<td style="text-align:right;">
11.3
</td>
<td style="text-align:right;">
66.7
</td>
<td style="text-align:right;">
152
</td>
<td style="text-align:right;">
566432
</td>
</tr>
<tr>
<td style="text-align:left;">
Arizona
</td>
<td style="text-align:right;">
2212
</td>
<td style="text-align:right;">
4530
</td>
<td style="text-align:right;">
1.8
</td>
<td style="text-align:right;">
70.55
</td>
<td style="text-align:right;">
7.8
</td>
<td style="text-align:right;">
58.1
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
113417
</td>
</tr>
<tr>
<td style="text-align:left;">
Arkansas
</td>
<td style="text-align:right;">
2110
</td>
<td style="text-align:right;">
3378
</td>
<td style="text-align:right;">
1.9
</td>
<td style="text-align:right;">
70.66
</td>
<td style="text-align:right;">
10.1
</td>
<td style="text-align:right;">
39.9
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
51945
</td>
</tr>
<tr>
<td style="text-align:left;">
California
</td>
<td style="text-align:right;">
21198
</td>
<td style="text-align:right;">
5114
</td>
<td style="text-align:right;">
1.1
</td>
<td style="text-align:right;">
71.71
</td>
<td style="text-align:right;">
10.3
</td>
<td style="text-align:right;">
62.6
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
156361
</td>
</tr>
<tr>
<td style="text-align:left;">
Colorado
</td>
<td style="text-align:right;">
2541
</td>
<td style="text-align:right;">
4884
</td>
<td style="text-align:right;">
0.7
</td>
<td style="text-align:right;">
72.06
</td>
<td style="text-align:right;">
6.8
</td>
<td style="text-align:right;">
63.9
</td>
<td style="text-align:right;">
166
</td>
<td style="text-align:right;">
103766
</td>
</tr>
<tr>
<td style="text-align:left;">
Connecticut
</td>
<td style="text-align:right;">
3100
</td>
<td style="text-align:right;">
5348
</td>
<td style="text-align:right;">
1.1
</td>
<td style="text-align:right;">
72.48
</td>
<td style="text-align:right;">
3.1
</td>
<td style="text-align:right;">
56.0
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
4862
</td>
</tr>
<tr>
<td style="text-align:left;">
Delaware
</td>
<td style="text-align:right;">
579
</td>
<td style="text-align:right;">
4809
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:right;">
70.06
</td>
<td style="text-align:right;">
6.2
</td>
<td style="text-align:right;">
54.6
</td>
<td style="text-align:right;">
103
</td>
<td style="text-align:right;">
1982
</td>
</tr>
<tr>
<td style="text-align:left;">
Florida
</td>
<td style="text-align:right;">
8277
</td>
<td style="text-align:right;">
4815
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
70.66
</td>
<td style="text-align:right;">
10.7
</td>
<td style="text-align:right;">
52.6
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
54090
</td>
</tr>
<tr>
<td style="text-align:left;">
Georgia
</td>
<td style="text-align:right;">
4931
</td>
<td style="text-align:right;">
4091
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:right;">
68.54
</td>
<td style="text-align:right;">
13.9
</td>
<td style="text-align:right;">
40.6
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
58073
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clear all</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="hw1" class="section level1">
<h1>HW1</h1>
<div id="exercise-3.3" class="section level2">
<h2>exercise 3.3</h2>
<p>The Pareto(a,b) distribution has cdf <span class="math display">\[F\left ( x \right ) =1-\left (
\frac{b}{x}  \right )^a,  x\ge b&gt; 0,a&gt; 0 \]</span> Derive the
probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform
method to simulate a random sample from the Pareto(2,2) distribution.
Graph the density histogram of sample with the Pareto(2,2) density
superimposed for comparison.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>According to chap02.pdf, my solution is as follows.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>invtr_pareto <span class="ot">=</span> <span class="cf">function</span>(a,b,n){      <span class="co">#inverse transformation for pareto(a,b)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  number <span class="ot">=</span> n</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">runif</span>(number)     <span class="co">#uniform(0,1)</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> (<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>u))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>a)<span class="sc">*</span>b      <span class="co">#inversed function for F()</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(x,<span class="at">prob =</span> <span class="cn">TRUE</span>,<span class="at">main =</span> <span class="fu">expression</span>( <span class="st">&quot;pareto distribution&quot;</span> ),<span class="at">col =</span> <span class="st">&quot;green&quot;</span> )</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">200</span>, <span class="fl">0.1</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(y,b<span class="sc">^</span>a<span class="sc">*</span>a<span class="sc">*</span>y<span class="sc">^</span>(<span class="sc">-</span>a<span class="dv">-1</span>),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)   <span class="co">#density corresponding to F()</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">invtr_pareto</span>(<span class="at">a=</span><span class="dv">2</span>,<span class="at">b=</span><span class="dv">2</span>,<span class="at">n=</span><span class="dv">5000</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-3.7" class="section level2">
<h2>exercise 3.7</h2>
<p>Write a function to generate a random sample of size n from the
Beta(a,b) distribution by the acceptance-rejection method. Generate a
random sample size 1000 from Beta(3,2) distribution. Graph the histogram
of the sample with the theoretical Beta(3,2) density superimposed.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p>maximum for pdf f(x) occurs at <span class="math inline">\(\frac{\alpha -1}{\alpha + \beta -2}\)</span> if
there is a maximum for it. Take this maximum value as t(x) and t(x)
majorizes f(x).So we can perform Acceptance-rejection algorithm as
follows:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>beta_pdf <span class="ot">=</span> <span class="cf">function</span>(x,a,b){   <span class="co">#pdf for beta distribution</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(b<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">beta</span>(a,b)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>ar_beta <span class="ot">=</span> <span class="cf">function</span>(a,b,n){</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">=</span> <span class="dv">0</span>   <span class="co">#counter for acception</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">=</span> <span class="dv">0</span>   <span class="co">#iterations</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">0</span>)   <span class="co">#initiation</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  max_p <span class="ot">=</span> (a<span class="dv">-1</span>)<span class="sc">/</span>(a<span class="sc">+</span>b<span class="dv">-2</span>)   <span class="co"># max point, if it exists</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  max_v <span class="ot">=</span> <span class="fu">beta_pdf</span>(max_p,a,b)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(k<span class="sc">&lt;</span>n){</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    j<span class="ot">=</span>j<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1</span>)    <span class="co"># random variate from g()</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>( <span class="fu">beta_pdf</span>(y,a,b)<span class="sc">/</span>max_v<span class="sc">&gt;</span>u ){   <span class="co"># we accept it</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>      k <span class="ot">=</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>      x[k] <span class="ot">=</span> y</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#make a plot:</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">density</span>(x), <span class="at">main =</span> <span class="fu">bquote</span>(<span class="st">&quot;AR method vs True&quot;</span>))</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  this.range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">beta_pdf</span>(x,a,b)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(this.range,<span class="fu">f</span>(this.range), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;A-R&quot;</span>, <span class="st">&quot;True&quot;</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ar_beta</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1000</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-3.12" class="section level2">
<h2>exercise 3.12</h2>
<p>Simulate a continuous Exponential-Gamma mixture. Suppose that the
rate parameter <span class="math inline">\(\Lambda\)</span> has <span class="math inline">\(Gamma(r,\beta )\)</span> distribution and Y has
Exp(<span class="math inline">\(\Lambda\)</span>) distribution. That is,
<span class="math display">\[(Y|\Lambda = \lambda )\sim f_{Y}\left (
y|\lambda  \right )=\lambda e^{-\lambda y}  \]</span> Generate 1000
random observations from this mixture with r=4 and <span class="math inline">\(\beta\)</span>=2.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<p>According to chap02.pdf, my solution is as follows.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>exp_gam_mix <span class="ot">=</span> <span class="cf">function</span>(n,r,beta){   <span class="co"># my generator</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">=</span> <span class="fu">rgamma</span>(n,r,beta)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">rexp</span>(n,lambda)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">exp_gam_mix</span>(<span class="at">n=</span><span class="fl">1e3</span>,<span class="at">r=</span><span class="dv">4</span>,<span class="at">beta=</span><span class="dv">2</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># observations generated.</span></span></code></pre></div>
</div>
<div id="exercise-3.13" class="section level2">
<h2>exercise 3.13</h2>
<p>It can be shown that the mixture in Exercise 3.12 has a Pareto
distribution with cdf <span class="math display">\[F(y)=1-\left(\frac{\beta}{\beta+y}\right)^r,\quad
y\geq0.\]</span> (this is an alternative parameterization of the Pareto
cdf given in Exercise 3.3.) Generate 1000 random observations from the
mixture with <span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2\)</span>. Compare the empirical and
theoretical (Pareto) distributions by graphing the density histogram of
the sample and superimposing the Pareto density curve.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<p>According to chap02.pdf, my solution is as follows.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>bet<span class="ot">=</span><span class="dv">2</span>;r<span class="ot">=</span><span class="dv">4</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">exp_gam_mix</span>(<span class="at">n=</span><span class="fl">1e3</span>,<span class="at">r=</span><span class="dv">4</span>,<span class="at">bet=</span><span class="dv">2</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ecdf</span>(x),<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>,<span class="dv">9</span>),<span class="at">col=</span><span class="st">&quot;orange&quot;</span>,<span class="at">lty=</span><span class="dv">1</span>,<span class="at">main=</span><span class="st">&quot;comparison&quot;</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">8</span>,.<span class="dv">01</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y,<span class="dv">1</span><span class="sc">-</span>(bet<span class="sc">/</span>(bet<span class="sc">+</span>y))<span class="sc">^</span>r,<span class="at">col=</span><span class="st">&quot;green&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;empirical&quot;</span>, <span class="st">&quot;pareto&quot;</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;orange&quot;</span>, <span class="st">&quot;green&quot;</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clear all</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="hw2" class="section level1">
<h1>HW2</h1>
<div id="exercise-1" class="section level2">
<h2>exercise 1</h2>
<p>For <span class="math inline">\(n=10^4,2\times10^4,4\times10^4,6\times10^4,8\times10^4\)</span>,
apply the fast sorting algorithm to randomly permuted numbers of
1,…,n. Calculate computation time averaged over 100 simulations, denoted
by <span class="math inline">\(a_n\)</span>.</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<p>According to chap03.pdf, my solution is as follows.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>my_qsort <span class="ot">=</span> <span class="cf">function</span>(x){   <span class="co"># function for recursively quick sort.</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  num <span class="ot">=</span> <span class="fu">length</span>(x)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(num<span class="sc">==</span><span class="dv">0</span><span class="sc">||</span>num<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">=</span> x[<span class="dv">1</span>]</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">=</span> x[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    left <span class="ot">=</span> y[y<span class="sc">&lt;</span>a]</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    right <span class="ot">=</span> y[y<span class="sc">&gt;=</span>a]</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">my_qsort</span>(left),a,<span class="fu">my_qsort</span>(right)))}</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>numbers <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1e4</span>,<span class="dv">2</span><span class="sc">*</span><span class="fl">1e4</span>,<span class="dv">4</span><span class="sc">*</span><span class="fl">1e4</span>,<span class="dv">6</span><span class="sc">*</span><span class="fl">1e4</span>,<span class="dv">8</span><span class="sc">*</span><span class="fl">1e4</span>)    <span class="co"># how many numbers</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>an <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">5</span>)       <span class="co"># averged runtime for length n</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>i <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Here is the result of runtimes:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Here is the result of runtimes:&quot;</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(number <span class="cf">in</span> numbers){</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  runtime <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    mysample <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>number)     <span class="co"># get randomly permuted numbers</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    runtime[j] <span class="ot">=</span> <span class="fu">system.time</span>(<span class="fu">my_qsort</span>(mysample))[<span class="dv">1</span>]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  an[i]<span class="ot">=</span><span class="fu">mean</span>(runtime)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;  runtime for numbers of length&quot;</span>,number,<span class="st">&quot;is&quot;</span>,an[i]))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;  runtime for numbers of length 10000 is 0.0201&quot;
## [1] &quot;  runtime for numbers of length 20000 is 0.0394999999999998&quot;
## [1] &quot;  runtime for numbers of length 40000 is 0.0806000000000002&quot;
## [1] &quot;  runtime for numbers of length 60000 is 0.1241&quot;
## [1] &quot;  runtime for numbers of length 80000 is 0.1687&quot;</code></pre>
<p>Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n:=n\log n\)</span>, and graphically show the
results(Scatter plot and regression line).</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<p>My solution and plot with regression line are as follows.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>tn <span class="ot">=</span> numbers<span class="sc">*</span><span class="fu">log</span>(numbers)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>mymodel <span class="ot">=</span> <span class="fu">lm</span>(an <span class="sc">~</span> tn)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tn,an)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(mymodel,<span class="at">col =</span> <span class="st">&quot;orange&quot;</span>)    <span class="co"># add regression line</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-5.6" class="section level2">
<h2>exercise 5.6</h2>
<p>In Example 5.7 the control variate approach was illustrated for Monte
Carlo integration of <span class="math display">\[\theta = \int_{0}^{1}
e^x dx \]</span> Now we consider the antithetic variate approach.
Compute <span class="math inline">\(Cov(e^U,e^{1-U})\)</span> and <span class="math inline">\(Var(e^U+e^{1-U})\)</span>, where <span class="math inline">\(U\sim {\rm Uniform}(0,1)\)</span>. What is the
percent reduction in variance of <span class="math inline">\(\hat{\theta}\)</span> that can be achieved using
antithetic variates (compared with simple MC)?</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<p><span class="math display">\[\mathbb{E}\left ( e^{U} \right
)=\int_{0}^{1}e ^udu= e-1\]</span> Similarly, we have: <span class="math display">\[\mathbb{E}\left ( e^{1-U} \right )= e-1\]</span>
<span class="math display">\[\mathbb{E}\left ( e^{U}e^{1-U} \right
)=\mathbb{E}\left ( e \right ) =e\]</span> Thus we can compute: <span class="math display">\[Cov(e^{U},e^{1-U})=\mathbb{E}\left ( e^{U}e^{1-U}
\right )-\mathbb{E}\left ( e^{U} \right )\mathbb{E}\left ( e^{1-U}
\right )=-e^2+3e-1\]</span> <span class="math display">\[Var(e^{U}+e^{1-U})=\mathbb{E}\left ( e^{U}e^{1-U}
\right )^2-(\mathbb{E}\left ( e^{U}e^{1-U} \right
))^2=-3e^2+10e-5\]</span> Meanwhile,for simple MC:<br />
<span class="math display">\[Var(e^U)=\frac{e^2-1}{2}-(e-1)^2\]</span>
So we can compute the percent reduction compared with simple MC:<br />
<span class="math display">\[\frac{Var(e^U)-\frac{Var(e^{U}+e^{1-U})}{4}}{Var(e^U)}=0.983835=98.3835\%\]</span></p>
</div>
<div id="exercise-5.7" class="section level2">
<h2>exercise 5.7</h2>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach
and by the simple Monte Carlo method. Compute an empirical estimate of
the percent reduction in variance using the antithetic variate. Compare
the result with the theoretical value from Exercise 5.6.</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<p>We are about to estimate <span class="math inline">\(\theta
=\int_{0}^{1}e^xdx\)</span>,<br />
the simple Monte-Carlo estimator is: <span class="math display">\[\widehat{\theta
}=\frac{1}{m}\sum_{j=1}^{m}e^{U_{j}}  ,U_{j}\sim Uniform(0,1)
\]</span><br />
and The antithetic variable estimator is: <span class="math display">\[\widehat{\theta
}=\frac{1}{m}\sum_{j=1}^{m/2}{e^{U_{j}}+e^{1-U_{j}}}  ,U_{j}\sim
Uniform(0,1) \]</span><br />
So the solution is as follows:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>antitheticV_mc <span class="ot">=</span> <span class="cf">function</span>(<span class="at">nsim =</span> <span class="fl">1e5</span>) {    <span class="co"># antithetic variate approach,nsim is the number of simulation.</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">runif</span>(nsim<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> u</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">c</span>(u, v)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">=</span> <span class="fu">exp</span>(u)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(g)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>simple_mc <span class="ot">=</span> <span class="cf">function</span>(<span class="at">nsim =</span> <span class="fl">1e5</span>) {    <span class="co"># simple monte carlo</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">runif</span>(nsim)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">exp</span>(u)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(g)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>n_sim <span class="ot">=</span> <span class="fl">1e4</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>MC1 <span class="ot">&lt;-</span> MC2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_sim)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sim) {</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  MC1[i] <span class="ot">&lt;-</span> <span class="fu">simple_mc</span>(<span class="at">nsim=</span>n_sim)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  MC2[i] <span class="ot">&lt;-</span> <span class="fu">antitheticV_mc</span>(<span class="at">nsim=</span>n_sim)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>(<span class="fu">var</span>(MC1) <span class="sc">-</span> <span class="fu">var</span>(MC2))<span class="sc">/</span><span class="fu">var</span>(MC1)</span></code></pre></div>
<pre><code>## [1] 0.9685924</code></pre>
<p>The result of simulation is a little smaller than what we’ve
previously computed.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clear all</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="hw3" class="section level1">
<h1>HW3</h1>
<div id="exercise-5.13" class="section level2">
<h2>exercise 5.13</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,+\infty)\)</span> and are ‘close’ to <span class="math display">\[g(x)= \dfrac{x^2}{\sqrt{2 \pi}}\text{e}^{-
\frac{x^2}{2}}, \quad x&gt;1.\]</span> Which of your two importance
functions should produce the smaller variance in estimating <span class="math display">\[ \int_1^{+ \infty}\dfrac{x^2}{ \sqrt{2 \pi}}
\text{e}^{- \frac{x^2}{2}} \text{d}x\]</span> by importance sampling?
Explain. ## Answer The first function I choose is <span class="math display">\[f_1{} (x)=e^{-x},x&gt;1 \]</span> The second
function <span class="math inline">\(f_2\)</span> is cdf of standard
normal distribution with x&gt;1.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">=</span> <span class="cf">function</span> (x) {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>xseq <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.01</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>yg <span class="ot">=</span> <span class="fu">g</span>(xseq)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">=</span> <span class="fu">exp</span>(<span class="sc">-</span>xseq)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">=</span> <span class="fu">dnorm</span>(xseq)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># to draw the density functions:</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>ymax <span class="ot">=</span> <span class="fu">max</span>(<span class="fu">c</span>(yg,y1,y2))</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xseq,yg,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,ymax),<span class="at">main=</span><span class="st">&quot;functions comparison&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;x&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;y&quot;</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(xseq,y1,<span class="at">col=</span><span class="st">&quot;orange&quot;</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(xseq,y2,<span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;g&quot;</span>,<span class="st">&quot;f1&quot;</span>,<span class="st">&quot;f2&quot;</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;orange&quot;</span>,<span class="st">&quot;green&quot;</span>),<span class="at">lty=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to draw the ratios:</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>ymax <span class="ot">=</span> <span class="fu">max</span>(<span class="fu">c</span>(yg<span class="sc">/</span>y1,yg<span class="sc">/</span>y2))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xseq,yg<span class="sc">/</span>y1,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="st">&quot;orange&quot;</span>,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,ymax),<span class="at">main=</span><span class="st">&quot;ratios comparison&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;x&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;g/f&quot;</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(xseq,yg<span class="sc">/</span>y2,<span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;f1&quot;</span>,<span class="st">&quot;f2&quot;</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;orange&quot;</span>,<span class="st">&quot;green&quot;</span>),<span class="at">lty=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>According to the density function and ratio plots above, we can guess
<span class="math inline">\(f_1\)</span> is closer to g and therefore
should produce the smaller variance by importance sampling.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">10000</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>theta_hat <span class="ot">=</span> se <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">=</span><span class="fu">rexp</span>(m,<span class="dv">1</span>)    <span class="co"># importance sampling for f1</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>fg1 <span class="ot">=</span> <span class="fu">g</span>(x1)<span class="sc">/</span><span class="fu">exp</span>(<span class="sc">-</span>x1)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>theta_hat[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">mean</span>(fg1);se[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">sd</span>(fg1)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">=</span><span class="fu">rnorm</span>(m)   <span class="co"># importance sampling for f2</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>fg2 <span class="ot">=</span> <span class="fu">g</span>(x2)<span class="sc">/</span><span class="fu">dnorm</span>(x2)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>theta_hat[<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">mean</span>(fg2);se[<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">sd</span>(fg2)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>t <span class="ot">=</span> <span class="fu">rbind</span>(theta_hat,se)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(t) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;f1&quot;</span>,<span class="st">&quot;f2&quot;</span>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t)</span></code></pre></div>
<pre><code>##                  f1       f2
## theta_hat 0.3996147 0.418218
## se        0.5842884 1.193842</code></pre>
<p>Simulation also indicates smaller variance of <span class="math inline">\(f_1\)</span>.</p>
</div>
<div id="exercise-5.15" class="section level2">
<h2>exercise 5.15</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13
and compare it with results of Example 5.10.</p>
<p><span class="math inline">\(\frac{g(x)}{f_3(x)}=\frac{1-e^{-1}}{1+x^2}\)</span>In
inverse transform method we have <span class="math inline">\(log(1 - u(1
- exp(-1)))\)</span>, so in stratified importance sampling we divide the
interval [0,1] into subintervals <span class="math inline">\(log(1 - a(1
- exp(-1)))\)</span>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">=</span> <span class="fl">1e5</span>;k <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">=</span> M<span class="sc">/</span>k <span class="co">#replicates per stratum</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">50</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>T2_k <span class="ot">=</span> <span class="fu">numeric</span>(k)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>stra_est <span class="ot">=</span> <span class="fu">numeric</span>(N)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>newfunc <span class="ot">=</span> <span class="cf">function</span>(x)  (<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&lt;</span><span class="dv">1</span>)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    fk1 <span class="ot">=</span> <span class="sc">-</span><span class="fu">log</span>( <span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>(j<span class="dv">-1</span>)<span class="sc">/</span>k )</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    fk2 <span class="ot">=</span> <span class="sc">-</span><span class="fu">log</span>( <span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>j<span class="sc">/</span>k )</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">=</span> <span class="fu">runif</span>(M<span class="sc">*</span>(fk2<span class="sc">-</span>fk1))    <span class="co"># so there are M in total for one N.</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">=</span> <span class="sc">-</span><span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>fk1)<span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>u<span class="sc">/</span>k )    <span class="co"># random numbers of 5*f3 in this subinterval</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    T2_k[j] <span class="ot">=</span> <span class="fu">mean</span>( (<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">/</span>((<span class="dv">1</span><span class="sc">+</span>X<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="dv">5</span>) )</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  stra_est[i] <span class="ot">=</span> <span class="fu">sum</span>(T2_k)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(stra_est)</span></code></pre></div>
<pre><code>## [1] 0.5247924</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(stra_est)</span></code></pre></div>
<pre><code>## [1] 6.449056e-05</code></pre>
<p>The results above show that <span class="math inline">\(\widehat{\theta} =0.5248117\)</span>, and an
estimated standard error 5.116119e-05. This standard error is better
than what we got in example 5.10 (where <span class="math inline">\(\widehat{\theta} =0.5257801\)</span> and estimated
standard error was 0.0970314)</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clear all</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="hw4" class="section level1">
<h1>HW4</h1>
<div id="exercise-6.4" class="section level2">
<h2>exercise 6.4</h2>
<p>Suppose that <span class="math inline">\(X_1,...,X_n\)</span> are a
random sample from a lognormal distribution with unknown parameters.
Construct a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain
an empirical estimate of the confidence level.</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<p>Here we construct the required 95% confidence interval for the
parameter <span class="math inline">\(\mu\)</span> : According to this
exercise, <span class="math inline">\(X_1,...,X_n\)</span> follows
lognormal distribution with parameters, that is: <span class="math display">\[ln(X_i)\sim N(\mu,\sigma )\]</span> Now define
<span class="math inline">\(Y_i\doteq ln(X_i)\sim N(\mu,\sigma
)\)</span> Then we have: <span class="math display">\[\hat{\mu }
=\bar{Y} =\frac{1}{n} {\textstyle \sum_{i=1}^{n}Y_i}=  \frac{1}{n}
{\textstyle \sum_{i=1}^{n}ln(X_i)}\]</span> and an <span class="math inline">\(\alpha\)</span> interval for <span class="math inline">\(\mu\)</span> is: <span class="math display">\[\overline{Y} \pm A S/\sqrt{n}=\overline{ln(X)}
\pm A S/\sqrt{n}  \]</span> where <span class="math display">\[A=t_{1-\alpha
/2}(n-1),S^2=\frac{1}{n-1}  {\textstyle \sum_{i=1}^{n}(Y_i-\overline{Y}
)^2}\]</span></p>
<p>Here are the functions for this exercise:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all before start:</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>get_data <span class="ot">=</span> <span class="cf">function</span>(n,mu,sig){     <span class="co"># function for data generation</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">rlnorm</span>(n,mu,sig)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( x )</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>make_ucl <span class="ot">=</span> <span class="cf">function</span>(m,n,mu,sig,alpha){    <span class="co"># function for making confidence interval</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  ucl <span class="ot">=</span> <span class="fu">replicate</span>(m,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">expr =</span> {</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>                    x <span class="ot">=</span> <span class="fu">rlnorm</span>(n,<span class="at">meanlog =</span> mu,<span class="at">sdlog =</span> sig)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>                    y <span class="ot">=</span> <span class="fu">log</span>(x)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">abs</span>( <span class="fu">sqrt</span>(n)<span class="sc">*</span>(<span class="fu">mean</span>(y)<span class="sc">-</span>mu)<span class="sc">/</span><span class="fu">sd</span>(y) )</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>                  }   )</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( <span class="fu">mean</span>(ucl<span class="sc">&lt;</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)) )</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Here we do the estimating:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">50</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>sig<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fl">1e4</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.05</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">make_ucl</span>(m,n,mu,sig,alpha)    <span class="co"># we perform simulation here.</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;The obtained empirical estimate of the confidence level is&quot;</span>,res,<span class="st">&quot;this is a good result.&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;The obtained empirical estimate of the confidence level is 0.9526 this is a good result.&quot;</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<p>The obtained empirical estimate of the confidence level is 0.9526
this is a good result.</p>
</div>
<div id="exercise-6.8" class="section level2">
<h2>exercise 6.8</h2>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the F
test of equal variance, at significance level <span class="math inline">\(\alpha \doteq 0.055\)</span>. Compare the power of
the Count Five test and F test for small,medium and large sample sizes.
(Recall that the F test is not applicable for non-normal
distributions.)</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<p>Here are the functions for this exercise:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all before start:</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>count5test <span class="ot">=</span> <span class="cf">function</span>(x, y){    <span class="co"># function for count-five-test, from textbook</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">=</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">=</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  outx <span class="ot">=</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  outy <span class="ot">=</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)) <span class="sc">&gt;</span> <span class="dv">5</span>))</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>ftest <span class="ot">=</span> <span class="cf">function</span>(x,y,alpha){      <span class="co"># function for F-test</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  ftp <span class="ot">=</span> <span class="fu">var.test</span>(x,y)<span class="sc">$</span>p.value</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (<span class="fu">as.integer</span>(ftp<span class="sc">&lt;=</span>alpha))</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>get_data <span class="ot">=</span> <span class="cf">function</span>(mu1,sig1,n1,mu2,sig2,n2){     <span class="co"># function for data generation</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">rnorm</span>(n1,mu1,sig1)</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">=</span> <span class="fu">rnorm</span>(n2,mu2,sig2)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( <span class="fu">list</span>(<span class="st">&#39;x&#39;</span><span class="ot">=</span>x,<span class="st">&#39;y&#39;</span><span class="ot">=</span>y) )</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>data_output <span class="ot">=</span> <span class="cf">function</span>(f_res,c5t_res,size_list){     <span class="co"># make a dataframe for result output</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  mydf <span class="ot">=</span> <span class="fu">as.data.frame</span>( <span class="fu">matrix</span>( <span class="at">data =</span> <span class="fu">c</span>(c5t_res,f_res),</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>                                <span class="at">nrow =</span> <span class="fu">length</span>(size_list), <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>                                <span class="at">byrow =</span> <span class="cn">FALSE</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>                                ) )</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(mydf) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;count5test&quot;</span>,<span class="st">&quot;f_test&quot;</span>)</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(mydf) <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&quot;n =&quot;</span>,size_list)</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>  mydf</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Here I perform simulations:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fl">1e4</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>alpha0 <span class="ot">=</span> <span class="fl">0.055</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>n_list <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>) <span class="co"># from small to middle to large</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>ft_result <span class="ot">=</span> c5t_result <span class="ot">=</span> <span class="fu">numeric</span>(  <span class="fu">length</span>(n_list)  )</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(n <span class="cf">in</span> n_list){       <span class="co"># compute results for f_test and c5test for each sample size</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  sims <span class="ot">=</span> <span class="fu">replicate</span>(m,</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">expr =</span> {</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>                     mydata <span class="ot">=</span> <span class="fu">get_data</span>(<span class="at">mu1=</span><span class="dv">0</span>,<span class="at">sig1=</span><span class="dv">1</span>,<span class="at">n1=</span>n,<span class="at">mu2=</span><span class="dv">0</span>,<span class="at">sig2=</span><span class="fl">1.5</span>,<span class="at">n2=</span>n)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>                     x <span class="ot">=</span> mydata<span class="sc">$</span>x; y <span class="ot">=</span> mydata<span class="sc">$</span>y</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">&#39;c5t&#39;</span><span class="ot">=</span><span class="fu">count5test</span>(x,y),<span class="st">&#39;ft&#39;</span><span class="ot">=</span><span class="fu">ftest</span>(x,y,<span class="at">alpha =</span> alpha0))</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>                   }  )</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">=</span> <span class="fu">rowMeans</span>(sims)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  c5t_result[i] <span class="ot">=</span> results[[<span class="dv">1</span>]]; ft_result[i] <span class="ot">=</span> results[[<span class="dv">2</span>]]</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">=</span> i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">data_output</span>(ft_result,c5t_result,n_list))</span></code></pre></div>
<pre><code>##         count5test f_test
## n =10       0.1089 0.2218
## n =50       0.6582 0.8102
## n =100      0.8555 0.9831
## n =500      0.9902 1.0000
## n =1000     0.9980 1.0000</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<p>According to the results of simulation, power grows higher as sample
size grows, for both count-5-test and F-test. And for a fixed sample
size, power of equal variance F-test is higher than power of
count-5-test.</p>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
</div>
<div id="question1" class="section level2">
<h2>Question1</h2>
<p>If we obtain the powers for two methods under a particular simulation
setting with 10000 experiments: say, 0.651 for one method and 0.676 for
another method. Can we say the powers are different at 0.05 level?</p>
</div>
<div id="answer-11" class="section level2">
<h2>Answer</h2>
<p>No, we cannot say they are sure to be different at 0.05 level.</p>
</div>
<div id="question2" class="section level2">
<h2>Question2</h2>
<p>What is the corresponding hypothesis test problem?</p>
</div>
<div id="answer-12" class="section level2">
<h2>Answer</h2>
<p>The null hypothesis is <span class="math inline">\(H_0:power1=power2\)</span>,while the alternative
hypothesis is <span class="math inline">\(H_1:power1\ne
power2\)</span></p>
</div>
<div id="question3" class="section level2">
<h2>Question3</h2>
<p>Which test can we use? Z-test,two-sample t-test, paired-t test or
McNemar test?Why?</p>
</div>
<div id="answer-13" class="section level2">
<h2>Answer</h2>
<p>I think McNemar test is probably the best choice, because the results
of powers of two methods are random variables that are not
independent.They are powers of one same sample and therefore
dependent.Also McNemar test does not need the distribution to be already
known.</p>
</div>
<div id="question3-1" class="section level2">
<h2>Question3</h2>
<p>Please provide the least necessary information for hypothesis
testing.</p>
</div>
<div id="answer-14" class="section level2">
<h2>Answer</h2>
<p>results of powers of 2 methods in total (denoted as 2n);<br />
how many results where method 1 provides accepted results while method 2
doesn’t (denoted as B); how many results where method 2 provides
accepted results while method 1 doesn’t (denoted as C); then we need at
least these information: n, <span class="math inline">\((B-C)^2/(B+C)\)</span>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clear all</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="hw5" class="section level1">
<h1>HW5</h1>
<div id="answer-to-exercise-7.4" class="section level2">
<h2>Answer to exercise 7.4</h2>
<p>For random variable $X_{i} Exp( ) $,<br />
we have $L( ) ={}^n exp( -X_i ) $<br />
and its log likehood <span class="math inline">\(l\left ( \lambda \right
) =nlog\left ( \lambda \right ) -\lambda \sum X_i\)</span>.<br />
Therefore we can obtain an MLE $ $. <span class="math inline">\({\bar{x}
} =\)</span>=108.0833 and therefore $ =0.00925212$.<br />
Here are the functions needed for this exercise:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all before start:</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>bootstrap_result_get <span class="ot">=</span> <span class="cf">function</span>(x,R){   <span class="co"># get bootstrap</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  lambda_star <span class="ot">=</span> <span class="fu">numeric</span>(R)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(r <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R){</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    xstar <span class="ot">=</span> <span class="fu">sample</span>(x,<span class="at">replace =</span> T)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    lambda_star[r] <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(xstar)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(lambda_star)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>bootstrap_result_show <span class="ot">=</span> <span class="cf">function</span>(res,x){  <span class="co"># output</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  est.samp <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x)</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">c</span>(<span class="at">bias.boot =</span> <span class="fu">mean</span>(res)<span class="sc">-</span>est.samp,</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">se.boot =</span> <span class="fu">sd</span>(res)))</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Here we do the bootstrap:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(2000)</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">=</span> aircondit<span class="sc">$</span>hours</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>R<span class="ot">=</span><span class="fl">1e4</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>bootstrapRes <span class="ot">=</span> <span class="fu">bootstrap_result_get</span>(mydata,R)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="fu">bootstrap_result_show</span>(bootstrapRes,mydata)</span></code></pre></div>
<pre><code>##   bias.boot     se.boot 
## 0.001255016 0.004247482</code></pre>
<p>Another way to perform bootstrap is:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>mydata</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">=</span> <span class="cf">function</span>(data,inds){</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">=</span> data[inds]</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(d))</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(2000)</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>bootmle<span class="ot">=</span><span class="fu">boot</span>(x,f,<span class="at">R=</span><span class="fl">1e4</span>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>bootmle</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = x, statistic = f, R = 10000)
## 
## 
## Bootstrap Statistics :
##       original      bias    std. error
## t1* 0.00925212 0.001324623 0.004190542</code></pre>
<p>Both methods show reasonable results.</p>
</div>
<div id="answer-to-exercise-7.5" class="section level2">
<h2>Answer to exercise 7.5</h2>
<p>Here are the functions for this exercise:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">=</span> <span class="cf">function</span>(data,inds){</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">=</span> data[inds]</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(d))</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(2000)</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>boot.obj <span class="ot">=</span> <span class="fu">boot</span>(mydata,<span class="at">statistic =</span> f,<span class="at">R=</span><span class="fl">1e4</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">boot.ci</span>(boot.obj,<span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>)))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 10000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 34.6, 181.9 )   ( 26.0, 169.9 )  
## 
## Level     Percentile            BCa          
## 95%   ( 46.2, 190.2 )   ( 56.8, 223.7 )  
## Calculations and Intervals on Original Scale</code></pre>
<p>We can tell the required intervals from the output above. These
intervals differ because these methods converge at different speed. Just
as the lecture ppt shows, Bootstrap t confidence interval is second
order accurate, but not transformation respecting. The percentile
interval is transformation respecting, but only first order accurate.
The standard normal confidence interval is neither transformation
respecting nor second order accurate.</p>
</div>
<div id="answer-to-exercise-7.a" class="section level2">
<h2>Answer to exercise 7.A</h2>
<p>According to the lecture ppt,here we generate the data, compute the
required intervals and get the result as follows:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fl">1e1</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> <span class="fl">1e4</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">=</span><span class="dv">0</span>;sig<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>boot.mean <span class="ot">=</span> <span class="cf">function</span>(x,i){  <span class="fu">mean</span>(x[i]) }</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>ci.norm<span class="ot">=</span>ci.basic<span class="ot">=</span>ci.perc<span class="ot">=</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  mydata <span class="ot">=</span> <span class="fu">rnorm</span>(n,mu,sig)</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>mydata,<span class="at">statistic=</span>boot.mean, <span class="at">R =</span> <span class="dv">999</span>)</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>  ci.norm[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>];ci.basic[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>  ci.perc[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>And here is my output of results:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>myprint <span class="ot">=</span> <span class="cf">function</span>(ci.norm,ci.basic,ci.perc){</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;for normal interval:&quot;</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;  empirical coverage rates:&quot;</span>,<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.norm[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu),<span class="st">&quot;;&quot;</span>,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;miss on left:&quot;</span>,<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&gt;</span>mu),<span class="st">&quot;;&quot;</span>,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;miss on right:&quot;</span>,<span class="fu">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="sc">&lt;</span>mu),</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">sep=</span><span class="st">&quot; &quot;</span>))</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;for basic interval:&quot;</span>)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;  empirical coverage rates:&quot;</span>,<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.basic[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu),<span class="st">&quot;;&quot;</span>,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;miss on left:&quot;</span>,<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&gt;</span>mu),<span class="st">&quot;;&quot;</span>,</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;miss on right:&quot;</span>,<span class="fu">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="sc">&lt;</span>mu),</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">sep=</span><span class="st">&quot; &quot;</span>))</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;for percent interval:&quot;</span>)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;  empirical coverage rates:&quot;</span>,<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.perc[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu),<span class="st">&quot;;&quot;</span>,</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;miss on left:&quot;</span>,<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&gt;</span>mu),<span class="st">&quot;;&quot;</span>,</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;miss on right:&quot;</span>,<span class="fu">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="sc">&lt;</span>mu),</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">sep=</span><span class="st">&quot; &quot;</span>))</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a><span class="fu">myprint</span>(ci.norm,ci.basic,ci.perc)</span></code></pre></div>
<pre><code>## [1] &quot;for normal interval:&quot;
## [1] &quot;  empirical coverage rates: 0.8986 ; miss on left: 0.0507 ; miss on right: 0.0507&quot;
## [1] &quot;for basic interval:&quot;
## [1] &quot;  empirical coverage rates: 0.8979 ; miss on left: 0.0512 ; miss on right: 0.0509&quot;
## [1] &quot;for percent interval:&quot;
## [1] &quot;  empirical coverage rates: 0.8958 ; miss on left: 0.0522 ; miss on right: 0.052&quot;</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.norm[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu),<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="sc">&gt;</span>mu),<span class="fu">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="sc">&lt;</span>mu),</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.basic[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu),<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="sc">&gt;</span>mu),<span class="fu">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="sc">&lt;</span>mu),</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&lt;=</span>mu <span class="sc">&amp;</span> ci.perc[,<span class="dv">2</span>]<span class="sc">&gt;=</span>mu),<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="sc">&gt;</span>mu),<span class="fu">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="sc">&lt;</span>mu) ),</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>             <span class="dv">3</span>,<span class="dv">3</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(mat) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;for normal interval:&quot;</span>,<span class="st">&quot;for basic interval:&quot;</span>,<span class="st">&quot;for percent interval:&quot;</span>)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mat) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;empirical coverage rates&quot;</span>,<span class="st">&quot;miss on left&quot;</span>,<span class="st">&quot;miss on right&quot;</span>)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">as.data.frame</span>(mat))</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
empirical coverage rates
</th>
<th style="text-align:right;">
miss on left
</th>
<th style="text-align:right;">
miss on right
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
for normal interval:
</td>
<td style="text-align:right;">
0.8986
</td>
<td style="text-align:right;">
0.0507
</td>
<td style="text-align:right;">
0.0507
</td>
</tr>
<tr>
<td style="text-align:left;">
for basic interval:
</td>
<td style="text-align:right;">
0.8979
</td>
<td style="text-align:right;">
0.0512
</td>
<td style="text-align:right;">
0.0509
</td>
</tr>
<tr>
<td style="text-align:left;">
for percent interval:
</td>
<td style="text-align:right;">
0.8958
</td>
<td style="text-align:right;">
0.0522
</td>
<td style="text-align:right;">
0.0520
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all at the end:</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="hw6" class="section level1">
<h1>HW6</h1>
<div id="exercise-7.8" class="section level2">
<h2>Exercise 7.8</h2>
<p><strong>Solution:</strong></p>
<p>Here are the functions needed for this exercise:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all before start:</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>get_theta <span class="ot">=</span> <span class="cf">function</span>(mydata){    <span class="co"># how we can get the parameter theta</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  lam <span class="ot">=</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(mydata))<span class="sc">$</span>values</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  my_theta <span class="ot">=</span> lam[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lam)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(my_theta)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>get_jack <span class="ot">=</span> <span class="cf">function</span>(mytable){   <span class="co"># data analysis: obtain the jackknife estimates of bias and sd</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  theta_Hat <span class="ot">=</span> <span class="fu">get_theta</span>(mytable)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  theta_Jack <span class="ot">=</span>theta_Jack2 <span class="ot">=</span> <span class="fu">numeric</span>(n)</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>    theta_Jack[i] <span class="ot">=</span> <span class="fu">get_theta</span>(mytable[<span class="sc">-</span>i,])</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>  bias_Jack <span class="ot">=</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta_Jack)<span class="sc">-</span>theta_Hat)</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>  se_Jack <span class="ot">=</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta_Jack<span class="sc">-</span><span class="fu">mean</span>(theta_Jack))<span class="sc">^</span><span class="dv">2</span>)) </span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">theta.hat=</span>theta_Hat,<span class="at">bias.jack=</span>bias_Jack,<span class="at">se.jack=</span>se_Jack))</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Here is the result of jackknife’s bias and sd of the estimated
parameter.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to load the required data:</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co"># jackknife result output:</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">get_jack</span>(scor))</span></code></pre></div>
<pre><code>##   theta.hat   bias.jack     se.jack 
## 0.619115038 0.001069139 0.049552307</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all at the end:</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="exercise-7.11" class="section level2">
<h2>Exercise 7.11</h2>
<p><strong>Solution:</strong> At the beginning, we write the functions
that we need for this exercise. The get_modErrs function here is used to
get errors of each model, and it is written accordingly to the
leave-one-out method, with modifications to it.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all before start:</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co"># this function is to fit models on leave-two-out samples on n-fold cross validation and compare errors:</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>get_modErrs <span class="ot">=</span> <span class="cf">function</span>(magnetic,chemical){</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">c</span>() <span class="co"># errors for each model,initialized as empty</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (k1 <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)) {</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(k2 <span class="cf">in</span> (k1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n){</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">=</span> magnetic[<span class="sc">-</span><span class="fu">c</span>(k1,k2)]</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">=</span> chemical[<span class="sc">-</span><span class="fu">c</span>(k1,k2)]</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>    Model1 <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>    yhat11 <span class="ot">=</span> Model1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> Model1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k1]</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>    yhat12 <span class="ot">=</span> Model1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> Model1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k2]</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>    e1 <span class="ot">=</span> <span class="fu">c</span>(e1,<span class="fu">c</span>(magnetic[k1]<span class="sc">-</span>yhat11, magnetic[k2]<span class="sc">-</span>yhat12))</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>    Model2 <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>    yhat21 <span class="ot">=</span> Model2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> Model2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k1] <span class="sc">+</span> Model2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k1]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>    yhat22 <span class="ot">=</span> Model2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> Model2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k2] <span class="sc">+</span> Model2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k2]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>    e2 <span class="ot">=</span> <span class="fu">c</span>(e2,<span class="fu">c</span>(magnetic[k1] <span class="sc">-</span> yhat21, magnetic[k2]<span class="sc">-</span>yhat22))</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>    Model3 <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>    logyhat31 <span class="ot">=</span> Model3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> Model3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k1]</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>    yhat31 <span class="ot">=</span> <span class="fu">exp</span>(logyhat31)</span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>    logyhat32 <span class="ot">=</span> Model3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> Model3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k2]</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>    yhat32 <span class="ot">=</span> <span class="fu">exp</span>(logyhat32)</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>    e3 <span class="ot">=</span> <span class="fu">c</span>(e3,magnetic[k1] <span class="sc">-</span> yhat31,magnetic[k2] <span class="sc">-</span> yhat32)</span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>    Model4 <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>    logyhat41 <span class="ot">=</span> Model4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> Model4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[k1])</span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>    yhat41 <span class="ot">=</span> <span class="fu">exp</span>(logyhat41)</span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a>    logyhat42 <span class="ot">=</span> Model4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> Model4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[k2])</span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a>    yhat42 <span class="ot">=</span> <span class="fu">exp</span>(logyhat42)</span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a>    e4 <span class="ot">=</span> <span class="fu">c</span>(e4, magnetic[k1] <span class="sc">-</span> yhat41,magnetic[k2] <span class="sc">-</span> yhat42)</span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( <span class="fu">list</span>(<span class="at">errs=</span><span class="fu">c</span>(<span class="at">Model1.error=</span><span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>), <span class="at">Model2.error=</span><span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>),<span class="at">Model3.error=</span><span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>), <span class="at">Model4.error=</span><span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>))) )</span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Here is the output of results of errors for each model:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">=</span> <span class="fu">get_modErrs</span>(ironslag<span class="sc">$</span>magnetic,ironslag<span class="sc">$</span>chemical)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>( results<span class="sc">$</span>errs )</span></code></pre></div>
<pre><code>## Model1.error Model2.error Model3.error Model4.error 
##     19.57227     17.87018     18.45491     20.46718</code></pre>
<p>If we apply leave-two-out cross-validation to select the best model,
according to the prediction error croterion above, Model 2, the
quadratic model will fit best. Coefficients of Model2 are shown
below:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> magnetic <span class="sc">~</span> chemical <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">2</span>) ,<span class="at">data =</span> ironslag)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = magnetic ~ chemical + I(chemical^2), data = ironslag)
## 
## Coefficients:
##   (Intercept)       chemical  I(chemical^2)  
##      24.49262       -1.39334        0.05452</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all at the end:</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<p>So the selected model is:<br />
<span class="math display">\[\hat{Y}= 24.49262 -1.39334X+0.05452X^2
\]</span></p>
</div>
<div id="exercise-8.2" class="section level2">
<h2>Exercise 8.2</h2>
<p>Implement the bivariate Spearman rank correlation test for
independence [255] as a permutation test. The Spearman rank correlation
test statistic can Permutation Tests 243 be obtained from function cor
with method = “spearman”. Compare the achieved significance level of the
permutation test with the p-value reported by cor.test on the same
samples.</p>
<p><strong>Solution:</strong> According to the lecture ppt, we can write
functions for this exercise as below:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all at the start:</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>get_data <span class="ot">=</span> <span class="cf">function</span>(){</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">attach</span>(chickwts)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  my_x <span class="ot">=</span> <span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>])</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  my_y <span class="ot">=</span> <span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;sunflower&quot;</span>])</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">detach</span>(chickwts)</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>my_x,<span class="at">y=</span>my_y))</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>compare <span class="ot">=</span> <span class="cf">function</span>(x,y){  <span class="co">#data_analysis</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  mydata <span class="ot">=</span> <span class="fu">get_data</span>()</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> mydata<span class="sc">$</span>x; y <span class="ot">=</span> mydata<span class="sc">$</span>y</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">=</span> <span class="fu">length</span>(x)  <span class="co"># x and y are equal in length</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>  R <span class="ot">=</span> <span class="dv">500</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">=</span><span class="fu">c</span>(x,y)</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>  reps <span class="ot">=</span> <span class="fu">numeric</span>(R)</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>  K <span class="ot">=</span> <span class="fu">length</span>(z)</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>  cor0 <span class="ot">=</span> <span class="fu">cor</span>(x,y,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">=</span> <span class="fu">sample</span>(K,<span class="at">size=</span>n,<span class="at">replace =</span> F)</span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>    x1<span class="ot">=</span>z[k];y1<span class="ot">=</span>z[<span class="sc">-</span>k]</span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>    reps[i] <span class="ot">=</span> <span class="fu">cor.test</span>(x1,y1)<span class="sc">$</span>statistic</span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( <span class="fu">c</span>(<span class="at">achieved_significance_level_of_permutation=</span><span class="fu">mean</span>(<span class="fu">c</span>(cor0,reps)<span class="sc">&gt;=</span>cor0),</span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">cor_test_report_p_val=</span><span class="fu">cor.test</span>(<span class="at">x=</span>x,<span class="at">y=</span>y)<span class="sc">$</span>p.value) )</span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Results for comparison is:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">=</span> <span class="fu">get_data</span>()</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> mydata<span class="sc">$</span>x; y <span class="ot">=</span> mydata<span class="sc">$</span>y</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="fu">compare</span>(x,y)</span></code></pre></div>
<pre><code>## achieved_significance_level_of_permutation 
##                                  0.3992016 
##                      cor_test_report_p_val 
##                                  0.3562877</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all at the end:</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<p>In this case the achieved significance level of the permutation test
is larger than the p-value reported by cor.test on the same sample.</p>
</div>
</div>
<div id="hw7" class="section level1">
<h1>HW7</h1>
<div id="exercise-9.4" class="section level2">
<h2>Exercise 9.4</h2>
<p><strong>Solution:</strong></p>
<p>Here are the functions needed for this exercise:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all before start:</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># pdf for standard laplace distribution</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>standard_d_laplace <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x)) )</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="co"># function for a random Walk Metropolis</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>randomWalk.Metropolis <span class="ot">=</span> <span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">numeric</span>(N)</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">=</span> x0</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">runif</span>(N)</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> (<span class="fu">standard_d_laplace</span>(y) <span class="sc">/</span> <span class="fu">standard_d_laplace</span>(x[i<span class="dv">-1</span>])))</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="ot">=</span> y <span class="cf">else</span> {</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">=</span> x[i<span class="dv">-1</span>]</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>      k <span class="ot">=</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x, <span class="at">k=</span>k))</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a><span class="co"># function for gelman-rubin method</span></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W <span class="co">#G-R statistic</span></span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>mychains <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, N, X1) {</span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> X1</span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> (<span class="fu">standard_d_laplace</span>(y) <span class="sc">/</span> <span class="fu">standard_d_laplace</span>(x[i<span class="dv">-1</span>])))</span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span> {</span>
<span id="cb63-49"><a href="#cb63-49" aria-hidden="true" tabindex="-1"></a>        x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb63-50"><a href="#cb63-50" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-52"><a href="#cb63-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb63-53"><a href="#cb63-53" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-54"><a href="#cb63-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-55"><a href="#cb63-55" aria-hidden="true" tabindex="-1"></a><span class="co">#gelman_rubin for monitoring</span></span>
<span id="cb63-56"><a href="#cb63-56" aria-hidden="true" tabindex="-1"></a>gelman_rubin_monitor <span class="ot">=</span> <span class="cf">function</span>(sigma,seed,<span class="at">drawplot=</span>F){</span>
<span id="cb63-57"><a href="#cb63-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-58"><a href="#cb63-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb63-59"><a href="#cb63-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-60"><a href="#cb63-60" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co">#number of chains to generate</span></span>
<span id="cb63-61"><a href="#cb63-61" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">15000</span> <span class="co">#length of chains</span></span>
<span id="cb63-62"><a href="#cb63-62" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb63-63"><a href="#cb63-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-64"><a href="#cb63-64" aria-hidden="true" tabindex="-1"></a>  <span class="co">#choose overdispersed initial values</span></span>
<span id="cb63-65"><a href="#cb63-65" aria-hidden="true" tabindex="-1"></a>  x0 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">25</span>,<span class="dv">4</span>)</span>
<span id="cb63-66"><a href="#cb63-66" aria-hidden="true" tabindex="-1"></a>  <span class="co">#generate the chains</span></span>
<span id="cb63-67"><a href="#cb63-67" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>n)</span>
<span id="cb63-68"><a href="#cb63-68" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb63-69"><a href="#cb63-69" aria-hidden="true" tabindex="-1"></a>    X[i, ] <span class="ot">&lt;-</span> <span class="fu">mychains</span>(sigma, n, x0[i])</span>
<span id="cb63-70"><a href="#cb63-70" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-71"><a href="#cb63-71" aria-hidden="true" tabindex="-1"></a>  <span class="co">#compute diagnostic statistics</span></span>
<span id="cb63-72"><a href="#cb63-72" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb63-73"><a href="#cb63-73" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb63-74"><a href="#cb63-74" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb63-75"><a href="#cb63-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-76"><a href="#cb63-76" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(drawplot<span class="sc">==</span>T){</span>
<span id="cb63-77"><a href="#cb63-77" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plot psi for the four chains</span></span>
<span id="cb63-78"><a href="#cb63-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb63-79"><a href="#cb63-79" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb63-80"><a href="#cb63-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(psi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb63-81"><a href="#cb63-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span>i, <span class="at">ylab=</span><span class="fu">bquote</span>(psi))</span>
<span id="cb63-82"><a href="#cb63-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></span>
<span id="cb63-83"><a href="#cb63-83" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb63-84"><a href="#cb63-84" aria-hidden="true" tabindex="-1"></a>    rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb63-85"><a href="#cb63-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb63-86"><a href="#cb63-86" aria-hidden="true" tabindex="-1"></a>    rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb63-87"><a href="#cb63-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>,<span class="at">main=</span><span class="fu">paste</span>(<span class="st">&quot;sigma=&quot;</span>,sigma))</span>
<span id="cb63-88"><a href="#cb63-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb63-89"><a href="#cb63-89" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-90"><a href="#cb63-90" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-91"><a href="#cb63-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(psi)</span>
<span id="cb63-92"><a href="#cb63-92" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="result-output" class="section level1">
<h1>result output:</h1>
<p>Here is the acceptance rates of each chain:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2022</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">15000</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">=</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">=</span> <span class="dv">25</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>rw1 <span class="ot">=</span> <span class="fu">randomWalk.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>rw2 <span class="ot">=</span> <span class="fu">randomWalk.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>rw3 <span class="ot">=</span> <span class="fu">randomWalk.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>rw4 <span class="ot">=</span> <span class="fu">randomWalk.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="co">#number of candidate points rejected</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>Rejected <span class="ot">=</span> <span class="fu">cbind</span>(rw1<span class="sc">$</span>k, rw2<span class="sc">$</span>k, rw3<span class="sc">$</span>k, rw4<span class="sc">$</span>k)</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>Accepted <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">-</span>Rejected<span class="sc">/</span>N,<span class="at">nrow=</span><span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">4</span>)</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Accepted) <span class="ot">=</span> <span class="st">&quot;Accept rates&quot;</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Accepted) <span class="ot">=</span> <span class="fu">paste</span>(<span class="st">&quot;sigma&quot;</span>,sigma)</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Accepted)</span></code></pre></div>
<pre><code>##              sigma 0.05 sigma 0.5   sigma 2   sigma 16
## Accept rates     0.9824      0.83 0.5256667 0.09926667</code></pre>
<p>plot of convergence speed:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)) <span class="co">#display 4 graphs together</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>    rw <span class="ot">=</span> <span class="fu">cbind</span>(rw1<span class="sc">$</span>x, rw2<span class="sc">$</span>x, rw3<span class="sc">$</span>x, rw4<span class="sc">$</span>x)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot</span>(rw[,j], <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">xlab=</span><span class="fu">bquote</span>(sigma <span class="sc">==</span> .(<span class="fu">round</span>(sigma[j],<span class="dv">3</span>))),</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylim=</span><span class="fu">range</span>(rw[,j]) )</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>    }</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))  <span class="co"># reset default</span></span></code></pre></div>
<p>From the plots we can see the difference in convergence speed
resulting from different values of sigma, which tends to be slow when
sigma is small and grows larger with sigma.</p>
<p>gelman-rubin method for monitoring convergence for each value of
sigma:<br />
(<span class="math inline">\(\hat{R} &lt;1.2\)</span>)</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>seed<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>monitor1<span class="ot">=</span><span class="fu">gelman_rubin_monitor</span>(<span class="fl">0.05</span>,seed)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>monitor2<span class="ot">=</span><span class="fu">gelman_rubin_monitor</span>(<span class="fl">0.5</span>,seed)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>monitor3<span class="ot">=</span><span class="fu">gelman_rubin_monitor</span>(<span class="dv">2</span>,seed)</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>monitor4<span class="ot">=</span><span class="fu">gelman_rubin_monitor</span>(<span class="dv">16</span>,seed)</span></code></pre></div>
<p>clear variables:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all at the end:</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<div id="exercise-9.7" class="section level2">
<h2>Exercise 9.7</h2>
<p><strong>Solution:</strong> Here are the functions that we need for
this exercise.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all before start:</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="co">#function for bivariate sample chain generation:</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>my_chain_generator <span class="ot">=</span> <span class="cf">function</span>(<span class="at">N=</span><span class="dv">5000</span>,<span class="at">burn=</span><span class="dv">1000</span>,<span class="at">rho=</span><span class="fl">0.9</span>,<span class="at">mu1=</span><span class="dv">0</span>,<span class="at">mu2=</span><span class="dv">0</span>,<span class="at">sigma1=</span><span class="dv">1</span>,<span class="at">sigma2=</span><span class="dv">1</span>,<span class="at">seed=</span><span class="dv">0</span>){</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  s1 <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  s2 <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co"># to store the chain</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>, ] <span class="ot">=</span> <span class="fu">c</span>(mu1, mu2) <span class="co"># to initiate</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>    x2 <span class="ot">=</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>    m1 <span class="ot">=</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (x2 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>    X[i, <span class="dv">1</span>] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">=</span> X[i, <span class="dv">1</span>]</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>    m2 <span class="ot">=</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>    X[i, <span class="dv">2</span>] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">=</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x, <span class="at">X=</span>X))</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a><span class="co"># function for regression model fit and checking residuals for normality and constant variance</span></span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a>model_fit <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a>  myfit <span class="ot">=</span> <span class="fu">lm</span>(x[,<span class="dv">2</span>]<span class="sc">~</span>x[,<span class="dv">1</span>])</span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(myfit)</span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">mar=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(myfit,<span class="at">cex=</span><span class="fl">0.3</span>) </span>
<span id="cb70-35"><a href="#cb70-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-36"><a href="#cb70-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-37"><a href="#cb70-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-38"><a href="#cb70-38" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb70-39"><a href="#cb70-39" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb70-40"><a href="#cb70-40" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb70-41"><a href="#cb70-41" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb70-42"><a href="#cb70-42" aria-hidden="true" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb70-43"><a href="#cb70-43" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb70-44"><a href="#cb70-44" aria-hidden="true" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb70-45"><a href="#cb70-45" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb70-46"><a href="#cb70-46" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb70-47"><a href="#cb70-47" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W <span class="co">#G-R statistic</span></span>
<span id="cb70-48"><a href="#cb70-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb70-49"><a href="#cb70-49" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Here we generate data and plot the generated sample after discarding
a suitable burn-in sample(1000):</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>N<span class="ot">=</span><span class="dv">5000</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>mysample <span class="ot">=</span> <span class="fu">my_chain_generator</span>(<span class="at">N=</span>N)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> mysample<span class="sc">$</span>x</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> mysample<span class="sc">$</span>X</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="co"># to plot the generated sample after discarding a suitable burn-in sample:</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">xlab=</span><span class="fu">bquote</span>(X[<span class="dv">1</span>]), <span class="at">ylab=</span><span class="fu">bquote</span>(X[<span class="dv">2</span>]), <span class="at">ylim=</span><span class="fu">range</span>(x[,<span class="dv">2</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
Now we check the residuals of the model for normality and constant
variance:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_fit</span>(<span class="at">x=</span>x)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = x[, 2] ~ x[, 1])
## 
## Coefficients:
## (Intercept)       x[, 1]  
##    0.003762     0.909222</code></pre>
<p><img src="data:image/png;base64,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" /><!-- -->
The fitted linear regression model is <span class="math display">\[\hat{Y}= -0.003762 + 0.909222X \]</span>
According to the plots above, we can conclude from the Normal q-q plot
that the normality of the residuals is a valid assumption, since qqplot
shows a straight line with very few outliers. And from the
scale-location plot we can see that the model basically follows constant
variance, since the plot is flat, showing the curve of a constant.</p>
<p>gelman-rubin monitoring:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co">#number of chains to generate</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> N <span class="co">#length of chains</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  X<span class="ot">=</span><span class="fu">t</span>(X)</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#compute diagnostic statistics</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#plot psi for the four chains</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">mar=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(psi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>,  <span class="at">xlab=</span>i, <span class="at">ylab=</span><span class="fu">bquote</span>(psi))</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></span></code></pre></div>
<p><img src="data:image/png;base64,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sEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsEYAsPb/VxL5llysmQ4AAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all at the end:</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="hw8" class="section level1">
<h1>HW8</h1>
<div id="exercise-7.8-1" class="section level2">
<h2>Exercise 7.8</h2>
<p>Set a random simulation and observe the performance of the three
methods above.<br />
Consider the two models: <span class="math display">\[M=a_M+\alpha
X+e_M\]</span> <span class="math display">\[Y=a_Y+\beta M+\gamma
X+e_Y\]</span> <span class="math display">\[e_M,e_Y\ iid\sim
N(0,1)\]</span> Consider these three set of parameters:<br />
&lt;1&gt; SET1 of Parameters:<br />
<span class="math display">\[\alpha =0,\beta =0,\gamma =1\]</span>
&lt;2&gt; SET2 of Parameters:<br />
<span class="math display">\[\alpha =0,\beta =1,\gamma =1\]</span>
&lt;3&gt; SET3 of Parameters:<br />
<span class="math display">\[\alpha =1,\beta =0,\gamma =1\]</span></p>
<p><strong>Solution:</strong> First, here are functions for generating
data in this simulation: In this condition we assnign X to distribution
N(0,3) and <span class="math inline">\(a_M=a_Y=0\)</span> in this
simulation.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all before start:</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co"># function for generation of X, whose distribution is based on our assignment, here is N(0,3)</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>getX <span class="ot">=</span> <span class="cf">function</span>(N,<span class="at">myseed=</span><span class="cn">NULL</span>){  <span class="co"># N is length of X</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( <span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">3</span>) )</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="co"># function for generation of M</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>getM <span class="ot">=</span> <span class="cf">function</span>(x,am,alp,<span class="at">myseed=</span><span class="cn">NULL</span>){</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(myseed)</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">=</span> <span class="fu">length</span>(x)</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( am<span class="sc">+</span>alp<span class="sc">*</span>x<span class="sc">+</span><span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">1</span>) )</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a><span class="co"># function for generation of Y</span></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>getY <span class="ot">=</span> <span class="cf">function</span>(m,x,ay,bet,gam,<span class="at">myseed=</span><span class="cn">NULL</span>){</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(myseed)</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">=</span> <span class="fu">length</span>(m)</span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( ay<span class="sc">+</span>bet<span class="sc">*</span>m<span class="sc">+</span>gam<span class="sc">*</span>x<span class="sc">+</span><span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">1</span>) )</span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>And this is the function for test of mediation effects:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mediation)</span></code></pre></div>
<pre><code>## Warning: package &#39;mediation&#39; was built under R version 4.2.2</code></pre>
<pre><code>## Loading required package: MASS</code></pre>
<pre><code>## 
## Attaching package: &#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:DAAG&#39;:
## 
##     hills</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## Loading required package: mvtnorm</code></pre>
<pre><code>## Loading required package: sandwich</code></pre>
<pre><code>## Warning: package &#39;sandwich&#39; was built under R version 4.2.2</code></pre>
<pre><code>## mediation: Causal Mediation Analysis
## Version: 4.5.0</code></pre>
<pre><code>## 
## Attaching package: &#39;mediation&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:DAAG&#39;:
## 
##     jobs</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function for test of mediation effects with package mediation:</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>mediate_test <span class="ot">=</span> <span class="cf">function</span>(<span class="at">myalpha=</span><span class="dv">0</span>,<span class="at">mybeta=</span><span class="dv">0</span>,<span class="at">mygamma=</span><span class="dv">1</span>,<span class="at">myseed=</span><span class="cn">NULL</span>){</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">getX</span>(<span class="at">N =</span> <span class="fl">1e3</span>,<span class="at">myseed =</span> myseed)</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">=</span> <span class="fu">getM</span>(<span class="at">x =</span> x,<span class="at">am =</span> <span class="dv">0</span>,<span class="at">alp =</span> myalpha,<span class="at">myseed =</span> myseed)</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">=</span> <span class="fu">getY</span>(<span class="at">m =</span> m,<span class="at">x =</span> x,<span class="at">ay =</span> <span class="dv">0</span>,<span class="at">bet =</span> mybeta,<span class="at">gam =</span> mygamma,<span class="at">myseed =</span> myseed)</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  dat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x,m,y),<span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(dat) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;m&quot;</span>,<span class="st">&quot;y&quot;</span>)</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>  model_xm <span class="ot">=</span> <span class="fu">lm</span>(m<span class="sc">~</span>x)</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>  model_xy <span class="ot">=</span> <span class="fu">lm</span>(y<span class="sc">~</span>m<span class="sc">+</span>x)</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>  model_MedEffect <span class="ot">=</span> <span class="fu">mediate</span>(model_xm,model_xy,<span class="at">treat =</span> <span class="st">&#39;x&#39;</span>,<span class="at">mediator =</span> <span class="st">&#39;m&#39;</span>, <span class="at">sims =</span> <span class="dv">1000</span>,<span class="at">boot =</span> T)</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(<span class="fu">lm</span>(y<span class="sc">~</span>m)))</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(model_MedEffect))</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>&lt;1&gt; SET1 of Parameters:<br />
,,</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mediate_test</span>(<span class="at">myalpha =</span> <span class="dv">0</span>,<span class="at">mybeta =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## Running nonparametric bootstrap</code></pre>
<pre><code>## 
## Call:
## lm(formula = y ~ m)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.8294 -2.3324  0.0068  2.1791  9.2691 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) -0.02018    0.09967  -0.202    0.840
## m           -0.07914    0.09745  -0.812    0.417
## 
## Residual standard error: 3.145 on 998 degrees of freedom
## Multiple R-squared:  0.0006605,  Adjusted R-squared:  -0.0003409 
## F-statistic: 0.6596 on 1 and 998 DF,  p-value: 0.4169
## 
## 
## Causal Mediation Analysis 
## 
## Nonparametric Bootstrap Confidence Intervals with the Percentile Method
## 
##                 Estimate 95% CI Lower 95% CI Upper p-value    
## ACME            8.24e-07    -8.87e-04         0.00    0.97    
## ADE             9.97e-01     9.78e-01         1.02  &lt;2e-16 ***
## Total Effect    9.97e-01     9.78e-01         1.02  &lt;2e-16 ***
## Prop. Mediated  8.26e-07    -8.87e-04         0.00    0.97    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Sample Size Used: 1000 
## 
## 
## Simulations: 1000</code></pre>
<p>From the output above we can see that ACME is small indicating small
indirect influence(influence of X on Y through M), and the existence of
large ADE indicating X has a strong direct influence on Y. Prop.Mediated
os 0.01 which is small and shows mediation effect is little. Result of
test of this simulation shows <span class="math inline">\(X\perp
M,M\perp Y\)</span> indicating <span class="math inline">\(\alpha
=0,\beta=0\)</span>.</p>
<p>&lt;2&gt; SET2 of Parameters:<br />
,,</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mediate_test</span>(<span class="at">myalpha =</span> <span class="dv">0</span>,<span class="at">mybeta =</span> <span class="dv">1</span>,<span class="at">myseed =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## Running nonparametric bootstrap</code></pre>
<pre><code>## 
## Call:
## lm(formula = y ~ m)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.8162 -2.0516 -0.0018  1.8785 11.0294 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.03577    0.09488  -0.377    0.706    
## m            1.97788    0.09510  20.797   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3 on 998 degrees of freedom
## Multiple R-squared:  0.3023, Adjusted R-squared:  0.3016 
## F-statistic: 432.5 on 1 and 998 DF,  p-value: &lt; 2.2e-16
## 
## 
## Causal Mediation Analysis 
## 
## Nonparametric Bootstrap Confidence Intervals with the Percentile Method
## 
##                Estimate 95% CI Lower 95% CI Upper p-value    
## ACME           -0.00490     -0.04509         0.04    0.81    
## ADE             1.00000      1.00000         1.00  &lt;2e-16 ***
## Total Effect    0.99510      0.95491         1.04  &lt;2e-16 ***
## Prop. Mediated -0.00493     -0.04722         0.04    0.81    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Sample Size Used: 1000 
## 
## 
## Simulations: 1000</code></pre>
<p>Result of test of this set of simulation shows <span class="math inline">\(X\perp M\)</span> indicating <span class="math inline">\(\alpha =0\)</span>.</p>
<p>&lt;3&gt; SET3 of Parameters:<br />
,,</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mediate_test</span>(<span class="at">myalpha =</span> <span class="dv">1</span>,<span class="at">mybeta =</span> <span class="dv">0</span>,<span class="at">myseed =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## Running nonparametric bootstrap</code></pre>
<pre><code>## 
## Call:
## lm(formula = y ~ m)
## 
## Residuals:
##        Min         1Q     Median         3Q        Max 
## -2.769e-13  5.500e-17  2.820e-16  4.950e-16  9.552e-15 
## 
## Coefficients:
##              Estimate Std. Error   t value Pr(&gt;|t|)    
## (Intercept) 9.830e-17  2.778e-16 3.540e-01    0.723    
## m           1.000e+00  8.955e-17 1.117e+16   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 8.783e-15 on 998 degrees of freedom
## Multiple R-squared:      1,  Adjusted R-squared:      1 
## F-statistic: 1.247e+32 on 1 and 998 DF,  p-value: &lt; 2.2e-16
## 
## 
## Causal Mediation Analysis 
## 
## Nonparametric Bootstrap Confidence Intervals with the Percentile Method
## 
##                 Estimate 95% CI Lower 95% CI Upper p-value    
## ACME            9.86e-01     9.64e-01         1.01  &lt;2e-16 ***
## ADE            -2.08e-16    -3.04e-16         0.00    0.94    
## Total Effect    9.86e-01     9.64e-01         1.01  &lt;2e-16 ***
## Prop. Mediated  1.00e+00     1.00e+00         1.00  &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Sample Size Used: 1000 
## 
## 
## Simulations: 1000</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all at the end:</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<p>Result of test of this simulation shows <span class="math inline">\(M\perp Y\)</span> indicating <span class="math inline">\(\beta=0\)</span>.</p>
</div>
<div id="exercise-7.11-1" class="section level2">
<h2>Exercise 7.11</h2>
<p>Consider the model: <span class="math display">\[P\left
\{  Y=1|X_1,X_2,X_3 \right \}=expit(a+b_1x_1+b_2x_2+b_3x_3)\]</span>
<span class="math display">\[X_1\sim P(1),
X_2\sim Exp(1),
X_3\sim B(1,0.5)\]</span></p>
<p><strong>Question 1:</strong><br />
&lt;1&gt; Write a function in R to implement the above requirements,
with its input <span class="math inline">\(N,b_1,b_2,b_3,f_0\)</span>
and output <span class="math inline">\(\alpha\)</span>.<br />
<strong>Solution:</strong></p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all before start:</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="co"># The following are the functions that are needed for this exercise:  </span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="co"># expit function</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>expit <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>x))</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a><span class="co"># find alpha by solving the equation</span></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>find_alpha <span class="ot">=</span> <span class="cf">function</span>(N,b1,b2,b3,f0,<span class="at">seed=</span><span class="cn">NULL</span>){</span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">=</span> <span class="fu">rpois</span>(N,<span class="dv">1</span>)</span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">=</span> <span class="fu">rexp</span>(N,<span class="dv">1</span>)</span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>  x3 <span class="ot">=</span> <span class="fu">rbinom</span>(N,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a>  my_pd <span class="ot">=</span> <span class="cf">function</span>(alpha,b1,b2,b3){</span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a>    temp <span class="ot">=</span> <span class="fu">exp</span>(<span class="sc">-</span>alpha<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3)</span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a>    temp <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>temp)</span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(temp) <span class="sc">-</span> f0</span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a>  mysolution <span class="ot">=</span> <span class="fu">uniroot</span>(my_pd,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">10</span>),b1,b2,b3)</span>
<span id="cb101-25"><a href="#cb101-25" aria-hidden="true" tabindex="-1"></a>  myresult <span class="ot">=</span> (<span class="fu">round</span>(<span class="fu">unlist</span>(mysolution),<span class="dv">5</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb101-26"><a href="#cb101-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-27"><a href="#cb101-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">result=</span>myresult, <span class="at">root=</span>myresult[[<span class="dv">1</span>]]))</span>
<span id="cb101-28"><a href="#cb101-28" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Question 2:</strong><br />
&lt;2&gt; Perform this function with input value <span class="math inline">\(N=10^6,b_1=0,b_2=1,b_3=-1,f_0=0.1,0.01,0.0010.0001.\)</span><br />
<strong>Solution:</strong></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fl">1e6</span>; b1 <span class="ot">=</span> <span class="dv">0</span>; b2 <span class="ot">=</span> <span class="dv">1</span>; b3 <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>f0_list <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1e-1</span>,<span class="fl">1e-2</span>,<span class="fl">1e-3</span>,<span class="fl">1e-4</span>)</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>alpha_list <span class="ot">=</span> <span class="fu">numeric</span>(<span class="at">length =</span> <span class="fu">length</span>(f0_list))</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (f0 <span class="cf">in</span> f0_list) {</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>  alpha_list[i] <span class="ot">=</span> <span class="fu">find_alpha</span>(<span class="at">N=</span>N,<span class="at">b1=</span>b1,<span class="at">b2=</span>b2,<span class="at">b3=</span>b3,<span class="at">f0=</span>f0,<span class="at">seed=</span><span class="cn">NULL</span>)<span class="sc">$</span>root</span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a><span class="co"># the result of trying this function is as follows:</span></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;result output:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;result output:&quot;</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(alpha_list) <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&quot; f0=&quot;</span>,f0_list)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(alpha_list)</span></code></pre></div>
<pre><code>##    f0=0.1   f0=0.01  f0=0.001  f0=1e-04 
##  -3.16857  -6.07011  -8.73179 -11.27301</code></pre>
<p><strong>Question 2:</strong><br />
&lt;3&gt; draw the scatter plot of <span class="math inline">\(f_0\)</span> vs <span class="math inline">\(\alpha\)</span>.<br />
<strong>Solution:</strong></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># because I think 4 points are too few for a scatter plot so I added some more points</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>f0_list <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">c</span>(<span class="fl">1e-4</span>,<span class="fl">1e-3</span>,<span class="dv">5</span><span class="sc">*</span><span class="fl">1e-3</span>,<span class="fl">1e-2</span>,<span class="dv">5</span><span class="sc">*</span><span class="fl">1e-2</span>),<span class="fu">seq</span>(<span class="fl">1e-1</span>,<span class="fl">0.99</span>,<span class="fl">0.05</span>))</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>alpha_list <span class="ot">=</span> <span class="fu">numeric</span>(<span class="at">length =</span> <span class="fu">length</span>(f0_list))</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (f0 <span class="cf">in</span> f0_list) {</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>  alpha_list[i] <span class="ot">=</span> <span class="fu">find_alpha</span>(<span class="at">N=</span>N,<span class="at">b1=</span>b1,<span class="at">b2=</span>b2,<span class="at">b3=</span>b3,<span class="at">f0=</span>f0,<span class="at">seed=</span><span class="cn">NULL</span>)<span class="sc">$</span>root</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a><span class="co"># the scatter plot is:</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f0_list,alpha_list,<span class="at">xlab =</span> <span class="st">&quot;f0&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;alpha&quot;</span>,<span class="at">main =</span> <span class="st">&quot;f0 vs alpha&quot;</span>,<span class="at">col=</span><span class="st">&quot;orange&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAq1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6OmY6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmtttmtv+QOgCQZgCQZjqQkDqQkGaQkLaQttuQtv+Q27aQ29uQ2/+2ZgC2Zjq2kGa225C227a229u22/+2/9u2///bkDrbkGbbtmbbtpDb27bb////pQD/tmb/25D/27b//7b//9v///+89v5AAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIOElEQVR4nO2dDXfaNhSGlTaMbG03WLeF7qNbQ/eRxe0KJOD//8tmWZZj2ZjXErIl4/c5pzQGWYbnXF1JxsgiJScRod9A7FAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEGAAIIOH2+E+Db7T4irHzd2u67EzNwjEVd3Pt9cgwCCdiJjkX1Wydxq12kIUp8pe3yffhLi1mbXSQhay8C5+rCSwXNY6RBaixcPaR5dmbFPr7ISb+7LXf57m+3y+k4Lysr+/YMQ17JAJuhD1lav74xyHgkl6I+lWOQbRUQoM2o7yRufMla8lu9zVwoqn9Bl88LP5TwSqok93hSCCg0qlvZSW/Yw36SfRV5AvfTVRu1QCnpxLwvMc0Gze/m4qJbzSCyCsmezv/RL1//U9vny5yvpoxR0q/dN8r/3y8JKUc4j0QjKnrhVn1/1by+fRwCHn0XR45U56EHXo5K0DLpqOY9EI0i2seLJp7cql/xeviKuf/uyrAvK01ZFUKWcR0IJ2teSdN7GftEJ9unXrKXol5S2fUNQPYIq5TwSSlDZmspPk30+URnlHN7p4FIdnJmkKzmoFFQp55GQA8WfzIGi7L3lVvZBv9vIdvYcQbPN08pI0pVerBpBupxHgglqTjV2eujz0RzPFCUNQeXYp5aDLidJqzmrMVl9zh6fZQZ6XY6kZe90/V6OA8oc9G/21Jv7NG30Yqqcx3c7xtMda78KTkNBAAoCUBBgjIIGhYIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFATwLEiMhlCC/FbXA9vtVv5HQS1si38UdJytfqSg41AQgIIQzEFtFL0Xe7EWdORoKMhkW3nMoSCT0ILsR/BDUaSc0IL6qu5sytTDHHSUSuDoXqxg8oKUj0bLKpm6oMIOBTWoRU499ZRMVVAjcmqpp2RygszIaW9amqkJqkdOa9PSTEZQW+S0NS3NVARZR46mJ0H6l9etv/gbSlBtBtE9cjT9CEr0oga7ttUNBhK0TavBYhM5ml4EHVallmR2fHW2vgUdGebYRY6mF0H7ZbmOxM5sZL3P5itNyvSSWkaO5sIiqCamfQ7amb5yUBFCg+Wgll7cOXBKeurF9kvVkFrix7ug1shxDZySkY+D2nrx8yNHM25B7b342ZGjGakgb704ZJyC/PXikJEJaj1Z4T1yNOMS5DzldGckglxPVpzPOAQFiByNgyA9CDxr8SIrQSEiR+MgaD3bJHIxQqsVsN2OW/8+eMDI0dgL2i8X6U4u5tw6jfB23MY4cMDI0bgIuk0fv3nI/9kfzuZ0xxDDHIi9IHkuY//9nZugjsdtfB88fORoHHJQkmXn9aLPJtYYKAfEpZtfz2VPdt4KfKeOGzInN4hxHBQyJzeISxC6FiUADoLgd17Ox92mwTutBi4DRR/rfx47blRNS+M2UOznuFE1LY3bQLEjJ6YjFyzosIIrnevp7IlMdTIHxYRDDuowTS2+DrOMoKhyj8ZSUIfYKMrJcXZnQRGK0fQ2Dlrnd1XpJijGpqXpb6CYiEVHQVEmZ42LoLyd4anq483LhqCjpzsuTdAuv9tFgm9flg25pxhBh5X61GsYQ5WrYE4f97JykDxZJtnBGUdnQZfVi+kIwifMuguKGJcclGeWBN/Xc6KCuo4VJyto4OOGhoIAFAToabLq77ihYQQBAguKeIRYEPbyl5jnGAUDX/5izuajnqUWBL385VIFnXH5i1ndZQryefnLZeYgj5e/bC+yF/N3+csIAijoOGgMKYiCEBQECDrVYA5C1cXfiYWerMYPBQEoCEBBgIEFxbvQZBuMIAC7eQAHigBONQA9Ceq0RNeEBXVbomu6grousDTZHNS+RFetuqn2YhEs8uaNvnLQ0Et09UZPvdjQS3T1B6caAAoCUBCApzsAPY2D3H5xGCP9RNBhhb6Ynrgg/MPWqQsqfq/grbpwhD1hFv9ULPgJs+gN9SkI/JhlFKeDKAhBQYCAgpiD4A/q2IsNVl1/BBM0GgIJ6lhpDAU6QkED1WNXaQwFOkJBA9VjV2kMBTpCQQPVY1dpDAU6QkED1WNXaQwFOjKauUEoKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEMCnoJ0Qz4stGxtONaRdliY+WUMiBF55FeBRkFyQeqffnbHhVIPc7rD+94ka5NrY6IoviD9B6hvp9by54VRDml80aimo9h7m9u+hgT9Banm4RF3maWw41SD/mr2zFGTUEJ2gr2VkF7+TMjacasg3bXOQWUNkTUw1/SIBGBtONeTNxVZQ7bBOHUWNeAXJn6SdJ0je7+rx5sx7OkXbxPKNs5qYUx5sEG2STorLVKxSiFGDUxQ3iLmbt48gowZlyzKKG0Q9ULQfSRs1RJaD8lYh35safyQuPYhRQ+oy1TBqWGdN9Nz77nGyCqAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUB4haUyO/WfVwn5k7UguTNcd2uE/FH5IJu3a408kjMgh5vhHjxl5cL6dyJWZC6vbLL1Y4eiV6QnysN3aEgQPSC2MROkAtikm6H3Twgv5kQB4rtqLstOV1Q7I2oBcUABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQE+B9a7V0kSQIsLwAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all at the end:</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="hw9" class="section level1">
<h1>HW9</h1>
<div id="exercise-after-class" class="section level2">
<h2>Exercise after class</h2>
<p>Suppose <span class="math inline">\(X_1,...,X_n\  iid \sim
Exp(\lambda)\)</span>. For some reason it’s only known that <span class="math inline">\(X_i\)</span> belongs to some interval (<span class="math inline">\(u_i,v_i\)</span>), where <span class="math inline">\(u_i&lt;v_i\)</span> are two non-random known
constants. This type of data is called interval-missing data.<br />
&lt;1&gt; Get MLE by maximizing likelihood function and by EM algorithm
and prove they are equal.<br />
&lt;2&gt; Suppose (<span class="math inline">\(u_i,v_i\)</span>), <span class="math inline">\(i=1,...,10\)</span> has observations
(11,12),(8,9),(27,28),(13,14),(16,17),(0,1),(23,24),(10,11),(24,25),(2,3).
Compute numeric MLE via the 2 methods mentioned above.</p>
<p><strong>Solution:</strong><br />
First to consider the likelihood function maximizing method:<br />
<span class="math display">\[L(\lambda ) = {\textstyle
\prod_{i=1}^{n}}P_{\lambda }(u_i\le x_i\le v_i) \]</span> Thus we have:
<span class="math display">\[L(\lambda ) =  {\textstyle
\prod_{i=1}^{n}}(e^{-\lambda  u_i}-e^{-\lambda v_i} ) \]</span><br />
Taking its log: <span class="math display">\[l(\lambda ) =  {\textstyle
\sum_{i=1}^{n}}log(e^{-\lambda u_i}-e^{-\lambda v_i})\]</span><br />
Taking deviation: <span class="math display">\[\frac{\partial
l}{\partial \lambda }l =  {\textstyle \sum_{i=1}^{n}}
\frac{-u_ie^{-\lambda u_i}+v_ie^{-\lambda v_i}}{e^{-\lambda
u_i}-e^{-\lambda v_i}} \]</span> So maximum likelihood occurs at the
root of <span class="math inline">\(\lambda\)</span> the equation
above.</p>
<p>Here are the functions needed for the first method(maximizing
likehood):</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all before start:</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="co"># function for the deviation of log-likelihood</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>log_likeh <span class="ot">=</span> <span class="cf">function</span>(lam,observs){</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>  myres <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">=</span> <span class="fu">nrow</span>(observs)</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>    ui <span class="ot">=</span> observs[i,<span class="dv">1</span>]</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>    vi <span class="ot">=</span> observs[i,<span class="dv">2</span>]</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>    myres <span class="ot">=</span> myres <span class="sc">+</span> <span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>lam<span class="sc">*</span>ui)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lam<span class="sc">*</span>vi))</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(myres)</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a><span class="co"># function for the deviation of log-likelihood, its root is MLE:</span></span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>log_likeh_dev <span class="ot">=</span> <span class="cf">function</span>(lam,observs){</span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a>  myres <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">=</span> <span class="fu">nrow</span>(observs)</span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a>    ui <span class="ot">=</span> observs[i,<span class="dv">1</span>]</span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a>    vi <span class="ot">=</span> observs[i,<span class="dv">2</span>]</span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a>    fac1 <span class="ot">=</span> <span class="fu">exp</span>(<span class="sc">-</span>lam<span class="sc">*</span>ui)</span>
<span id="cb108-25"><a href="#cb108-25" aria-hidden="true" tabindex="-1"></a>    fac2 <span class="ot">=</span> <span class="fu">exp</span>(<span class="sc">-</span>lam<span class="sc">*</span>vi)</span>
<span id="cb108-26"><a href="#cb108-26" aria-hidden="true" tabindex="-1"></a>    myres <span class="ot">=</span> myres<span class="sc">+</span>(<span class="sc">-</span>ui<span class="sc">*</span>fac1<span class="sc">+</span>vi<span class="sc">*</span>fac2)<span class="sc">/</span>(fac1<span class="sc">-</span>fac2)</span>
<span id="cb108-27"><a href="#cb108-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb108-28"><a href="#cb108-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(myres)</span>
<span id="cb108-29"><a href="#cb108-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb108-30"><a href="#cb108-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-31"><a href="#cb108-31" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the above function to see vaguely where the MLE is and return the root:</span></span>
<span id="cb108-32"><a href="#cb108-32" aria-hidden="true" tabindex="-1"></a>getMLE_method1<span class="ot">=</span> <span class="cf">function</span>(){</span>
<span id="cb108-33"><a href="#cb108-33" aria-hidden="true" tabindex="-1"></a>  lamlist <span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">0.01</span>,<span class="fl">0.25</span>,<span class="fl">0.001</span>)</span>
<span id="cb108-34"><a href="#cb108-34" aria-hidden="true" tabindex="-1"></a>  reslist <span class="ot">=</span> <span class="fu">numeric</span>(<span class="at">length =</span> <span class="fu">length</span>(lamlist))</span>
<span id="cb108-35"><a href="#cb108-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lamlist)) {</span>
<span id="cb108-36"><a href="#cb108-36" aria-hidden="true" tabindex="-1"></a>    reslist[i] <span class="ot">=</span> <span class="fu">log_likeh_dev</span>(lamlist[i],myobservs)</span>
<span id="cb108-37"><a href="#cb108-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb108-38"><a href="#cb108-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># take a peek:</span></span>
<span id="cb108-39"><a href="#cb108-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(lamlist,reslist,<span class="at">col=</span><span class="st">&quot;orange&quot;</span>,</span>
<span id="cb108-40"><a href="#cb108-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;lambda&quot;</span>,<span class="at">ylab =</span> <span class="st">&quot;loglikelihood_dev&quot;</span>,</span>
<span id="cb108-41"><a href="#cb108-41" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">&quot;where the MLE vaguely is&quot;</span></span>
<span id="cb108-42"><a href="#cb108-42" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb108-43"><a href="#cb108-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb108-44"><a href="#cb108-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb108-45"><a href="#cb108-45" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(log_likeh_dev,<span class="at">observs=</span>myobservs,<span class="at">lower=</span><span class="fl">0.03</span>,<span class="at">upper=</span><span class="fl">0.2</span>)</span>
<span id="cb108-46"><a href="#cb108-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(res<span class="sc">$</span>root)</span>
<span id="cb108-47"><a href="#cb108-47" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Data analysis:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the observations of data:</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>myobservs <span class="ot">=</span> <span class="fu">matrix</span>(</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">12</span>, <span class="dv">8</span>,<span class="dv">9</span>, <span class="dv">27</span>,<span class="dv">28</span>, <span class="dv">13</span>,<span class="dv">14</span>, <span class="dv">16</span>,<span class="dv">17</span>, <span class="dv">0</span>,<span class="dv">1</span>, <span class="dv">23</span>,<span class="dv">24</span>, <span class="dv">10</span>,<span class="dv">11</span>, <span class="dv">24</span>,<span class="dv">25</span>, <span class="dv">2</span>,<span class="dv">3</span>),</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol=</span><span class="dv">2</span>,<span class="at">byrow =</span> T)</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a><span class="co"># get mle via method 1</span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>mle1 <span class="ot">=</span> <span class="fu">getMLE_method1</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;For the first method(maximizing likehood), the answer is &quot;</span>,mle1,<span class="st">&quot;.&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;For the first method(maximizing likehood), the answer is  0.0719721534069877 .&quot;</code></pre>
<p>And the following are the em algorithm(Method 2):</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>method2 <span class="ot">=</span> <span class="cf">function</span>(lam0,<span class="at">lam1=</span><span class="dv">5</span>,obs1,obs2,N,eps){ <span class="co"># lam0: initial value; N: max_iterations</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  lam2 <span class="ot">=</span> lam0</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>( <span class="fu">abs</span>(lam1<span class="sc">-</span>lam2)<span class="sc">&gt;=</span>eps ){</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>    lam1 <span class="ot">=</span> lam2</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>    lam2 <span class="ot">=</span> <span class="fu">length</span>(obs1)<span class="sc">/</span><span class="fu">sum</span>(((lam1<span class="sc">*</span>obs1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lam1<span class="sc">*</span>obs1)<span class="sc">-</span>(lam1<span class="sc">*</span>obs2<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lam1<span class="sc">*</span>obs2))<span class="sc">/</span>(lam1<span class="sc">*</span>(<span class="fu">exp</span>(<span class="sc">-</span>lam1<span class="sc">*</span>obs1)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lam1<span class="sc">*</span>obs2))))</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(i<span class="sc">==</span>N) <span class="cf">break</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>    i<span class="ot">&lt;-</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(lam2)</span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a>em_sol <span class="ot">=</span> <span class="fu">method2</span>(<span class="at">lam0=</span><span class="fl">0.5</span>,</span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">lam1=</span><span class="dv">5</span>,</span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">obs1=</span>myobservs[,<span class="dv">1</span>],</span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">obs2=</span>myobservs[,<span class="dv">2</span>],</span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">N=</span><span class="fl">1e5</span>,</span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">eps=</span><span class="fl">1e-3</span>)</span>
<span id="cb112-21"><a href="#cb112-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-22"><a href="#cb112-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-23"><a href="#cb112-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;For the first method(maximizing likehood), the answer is &quot;</span>,em_sol,<span class="st">&quot;.&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;For the first method(maximizing likehood), the answer is  0.0719735791855385 .&quot;</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all at the end:</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="exercise-45-of-2.1.3-advanced-r." class="section level2">
<h2>Exercise 4,5 of 2.1.3 (Advanced R).</h2>
<p><strong>Exercise 4:</strong></p>
<p>Why do you need to use unlist() to convert a list into an atomic
vector? Why does not as.vector() work?</p>
<p><strong>Solution for exercise 4:</strong><br />
Because unlist() serves the use of converting a list to an atomic
vector. Meanwhile a list is already a vector, just not an atomic one, so
as.vector() does not work.</p>
<p><strong>Exercise 5:</strong></p>
<p>Why is 1==“1” true? Why is -1&lt;FALSE true? Why is “one”&lt;2
False?</p>
<p><strong>Solution for exercise 5:</strong><br />
1==“1” gives a TRUE because while the computer does its comparison, 1 is
converted into character type in the process.<br />
-1&lt;FALSE is true because FALSE was converted into 0 and -1&lt;0 thus
throws a TRUE.<br />
2 is met with characters “one” and was converted into “2”, then compared
to “one” in the number of character sequence.<br />
When doing these comparisons above, r follows an order like this:
logical&lt;integer&lt;float&lt;other(like characters) resulting in the
comparisons above.</p>
</div>
<div id="exercise-12-of-2.3.1-advanced-r." class="section level2">
<h2>Exercise 1,2 of 2.3.1 (Advanced R).</h2>
<p><strong>Exercise 1:</strong><br />
What does dim() return when applied to a vector?<br />
<strong>Solution:</strong><br />
The function dim() returns NULL when applied to a vector, as shown below
or in help(dim), because a vector is of dimension one and dim() cannot
give how many rows and cols it has.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>this_vec<span class="ot">=</span><span class="fu">as.vector</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>))</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="co"># this shows that x is a vector:</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">is.vector</span>(this_vec))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this shows return value of dim() when applied to a vector:</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dim</span>(this_vec))</span></code></pre></div>
<pre><code>## NULL</code></pre>
<p><strong>Exercise 2:</strong><br />
If is.matrix(x) is TRUE, what will is.array(x) return?<br />
<strong>Solution:</strong><br />
The function is.array(x) returns TRUE when is.matrix(x) is a TRUE. This
is because a matrix belongs to arrays. A matrix is a 2-dimensional(row
and column) array, while arrays in general may have a dimension more
than 2. An example below:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">is.matrix</span>(x))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">is.array</span>(x))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all at the end:</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="exercise-123-of-2.4.5-advanced-r." class="section level2">
<h2>Exercise 1,2,3 of 2.4.5 (Advanced R).</h2>
<p><strong>Exercise 1:</strong><br />
What attributes does a data frame possess?<br />
<strong>Solution:</strong><br />
It has attributes: names, class, row.names.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>mydf <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="co"># this is a data frame:</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">is.data.frame</span>(mydf))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># and has these following attributes: </span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">attributes</span>(mydf))</span></code></pre></div>
<pre><code>## $names
## [1] &quot;V1&quot; &quot;V2&quot; &quot;V3&quot;
## 
## $class
## [1] &quot;data.frame&quot;
## 
## $row.names
## [1] 1 2</code></pre>
<p><strong>Exercise 2:</strong><br />
What does as.matrix() do when applied to a data frame with columns of
different types?<br />
<strong>Solution:</strong><br />
It might do some changes to the type of columns. For example when one
column is character column, the rest of columns will be inverted into
character columns too. The convertion of types of column follows an
order like this: logical&lt;integer&lt;float&lt;other(like
characters).</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>mydf <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="st">&#39;I Am&#39;</span>,<span class="st">&#39;Another&#39;</span>,<span class="st">&#39;Type&#39;</span>,<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>,T,F,F,<span class="fl">5.5</span>,<span class="fl">5.6</span>,<span class="fl">5.7</span>),<span class="dv">3</span>,<span class="dv">5</span>))</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mydf)</span></code></pre></div>
<pre><code>##   V1      V2 V3    V4  V5
## 1  1    I Am  4  TRUE 5.5
## 2  2 Another  5 FALSE 5.6
## 3  3    Type  6 FALSE 5.7</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># as shown in this case, according to the convertion order, they are all into characters.</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as.matrix</span>(mydf))</span></code></pre></div>
<pre><code>##      V1  V2        V3  V4      V5   
## [1,] &quot;1&quot; &quot;I Am&quot;    &quot;4&quot; &quot;TRUE&quot;  &quot;5.5&quot;
## [2,] &quot;2&quot; &quot;Another&quot; &quot;5&quot; &quot;FALSE&quot; &quot;5.6&quot;
## [3,] &quot;3&quot; &quot;Type&quot;    &quot;6&quot; &quot;FALSE&quot; &quot;5.7&quot;</code></pre>
<p><strong>Exercise 3:</strong><br />
Can you have a data frame with 0 rows? 0 columns?<br />
<strong>Solution:</strong><br />
Yes, I can! :D As shown in the following chunk:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This dataframe has 4 cols and 0 row:</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>df_0row <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">row.names=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dim</span>(df_0row))</span></code></pre></div>
<pre><code>## [1] 4 0</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This dataframe has 0 col and 2 rows:</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>df_0row <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">col1=</span><span class="fu">integer</span>(<span class="at">length =</span> <span class="dv">0</span>),<span class="at">col2=</span><span class="fu">numeric</span>(<span class="at">length =</span> <span class="dv">0</span>))</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dim</span>(df_0row))</span></code></pre></div>
<pre><code>## [1] 0 2</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This dataframe has 0 col and 0 row:</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>df_empty <span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dim</span>(df_empty))</span></code></pre></div>
<pre><code>## [1] 0 0</code></pre>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all at the end:</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="hw10" class="section level1">
<h1>HW10</h1>
<div id="solution-to-exercise-2-page-204-advanced-r." class="section level2">
<h2>Solution to Exercise 2 (page 204, Advanced R).</h2>
<p>We can do this to apply it to each column of a dataframe after
loading package purrr:<br />
purrr::modify(df)<br />
where df is name of the dataframe.<br />
To apply it only to numeric column we can use the function modify_if()
:<br />
modify_if(df, is.numeric, scale01)<br />
where df is name of the dataframe.</p>
</div>
<div id="solution-to-exercise-1-page-213-advanced-r-a." class="section level2">
<h2>Solution to Exercise 1 (page 213, Advanced R) a.</h2>
<p>We use vapply() as follows:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we first create a sample matrix for demonstration:</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>mymat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">12</span>),<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mymat) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;col1&quot;</span>,<span class="st">&quot;col2&quot;</span>,<span class="st">&quot;col3&quot;</span>,<span class="st">&quot;col4&quot;</span>)</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>mydf <span class="ot">=</span> <span class="fu">as.data.frame</span>(mymat)  <span class="co"># my dataframe</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a><span class="co"># to compute sd of each column in a numeric data frame:</span></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(mydf, sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##      col1      col2      col3      col4 
## 1.1313282 1.3342478 2.3261700 0.7417374</code></pre>
</div>
<div id="solution-to-exercise-1-page-213-advanced-r-b." class="section level2">
<h2>Solution to Exercise 1 (page 213, Advanced R) b.</h2>
<p>we use vapply() twice as follows:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we first create another sample matrix for demonstration:</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>mymat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">12</span>),<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mymat) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;col1&quot;</span>,<span class="st">&quot;col2&quot;</span>,<span class="st">&quot;col3&quot;</span>,<span class="st">&quot;col4&quot;</span>)</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>mydf <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">as.data.frame</span>(mymat),<span class="at">col5=</span><span class="fu">c</span>(<span class="st">&quot;Not&quot;</span>,<span class="st">&quot;Numeric&quot;</span>,<span class="st">&quot;here!&quot;</span>))  <span class="co"># my dataframe</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mydf)</span></code></pre></div>
<pre><code>##         col1       col2         col3      col4    col5
## 1  1.5982377  0.5910040  1.012520232 -1.202602     Not
## 2 -0.7049396 -0.8364449 -0.005834381  1.379132 Numeric
## 3  0.3371603  1.5349668 -0.533910293  0.586795   here!</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;we can see that this dataframe does not contain numeric columns only!&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;we can see that this dataframe does not contain numeric columns only!&quot;</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to compute sd of each column in a numeric data frame:</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(mydf[<span class="fu">vapply</span>(mydf, is.numeric, <span class="fu">logical</span>(<span class="dv">1</span>))],</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>       sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##      col1      col2      col3      col4 
## 1.1533223 1.1938921 0.7860617 1.3225663</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all at the end:</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="exercise-three." class="section level2">
<h2>Exercise THREE.</h2>
<p>Implement a Gibbs sampler to generate a bivariate normal chain $(
X_t,Y_t ) $ with zero means, unit standard deviations, and correlation
0.9.</p>
<p><strong>Exercise &lt;1&gt;: </strong></p>
<p>&lt;1&gt; Write an Rcpp function.<br />
### Solution: The required Rcpp function is written and saved in
gibbsC.cpp.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="st">&#39;../src/gibbsC.cpp&#39;</span>)</span></code></pre></div>
<pre><code>## Warning in normalizePath(path.expand(path), winslash, mustWork): path[1]=&quot;D:/
## AAA_CODING/Rpkg/StatComp22062/src/../inst/include&quot;: 系统找不到指定的路径。</code></pre>
<p><strong>Exercise &lt;2&gt;:</strong></p>
<p>&lt;2&gt; Compare the corresponding generated random numbers with the
pure R language using the function “qqplot”.</p>
<div id="solution" class="section level3">
<h3>Solution:</h3>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FIRST, WE OBTAIN THE SAMPLE USING PURE R:</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="co"># R function for gibbs sampler:</span></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>my_gibbs_xy_r <span class="ot">=</span> <span class="cf">function</span>(mu, sig, rho, init0, N,<span class="at">seed=</span><span class="cn">NULL</span>) {</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># gibbs sampler for data generation in R</span></span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mu,sig and rho being parameters for distribution,init0 being initials and N being length of chain</span></span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> rho<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> sig</span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">=</span> Y <span class="ot">=</span> <span class="fu">numeric</span>(N)</span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>] <span class="ot">=</span> init0[<span class="dv">1</span>]; Y[<span class="dv">1</span>] <span class="ot">=</span> init0[<span class="dv">2</span>]</span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">=</span> Y[i<span class="dv">-1</span>]</span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a>    m1 <span class="ot">=</span> mu[<span class="dv">1</span>] <span class="sc">+</span> rho <span class="sc">*</span> (y <span class="sc">-</span> mu[<span class="dv">2</span>]) <span class="sc">*</span> sig[<span class="dv">1</span>] <span class="sc">/</span> sig[<span class="dv">2</span>]</span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a>    X[i] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s[<span class="dv">1</span>])</span>
<span id="cb150-15"><a href="#cb150-15" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">=</span> X[i]</span>
<span id="cb150-16"><a href="#cb150-16" aria-hidden="true" tabindex="-1"></a>    m2 <span class="ot">=</span> mu[<span class="dv">2</span>] <span class="sc">+</span> rho <span class="sc">*</span> (x <span class="sc">-</span> mu[<span class="dv">1</span>]) <span class="sc">*</span> sig[<span class="dv">2</span>] <span class="sc">/</span> sig[<span class="dv">1</span>]</span>
<span id="cb150-17"><a href="#cb150-17" aria-hidden="true" tabindex="-1"></a>    Y[i] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s[<span class="dv">2</span>])</span>
<span id="cb150-18"><a href="#cb150-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb150-19"><a href="#cb150-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">X =</span> X, <span class="at">Y =</span> Y))</span>
<span id="cb150-20"><a href="#cb150-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb150-21"><a href="#cb150-21" aria-hidden="true" tabindex="-1"></a><span class="co"># data gerneration in R:</span></span>
<span id="cb150-22"><a href="#cb150-22" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fl">1e3</span>;b <span class="ot">=</span> <span class="dv">1000</span>;rho <span class="ot">=</span> <span class="fl">0.9</span>;mu <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>);sigma <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb150-23"><a href="#cb150-23" aria-hidden="true" tabindex="-1"></a>my_chainR <span class="ot">=</span> <span class="fu">my_gibbs_xy_r</span>(mu, sigma, rho, <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), N)</span>
<span id="cb150-24"><a href="#cb150-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-25"><a href="#cb150-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-26"><a href="#cb150-26" aria-hidden="true" tabindex="-1"></a><span class="co"># NOW WE OBTAIN SAMPLE WITH Rcpp:</span></span>
<span id="cb150-27"><a href="#cb150-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-28"><a href="#cb150-28" aria-hidden="true" tabindex="-1"></a>mychainC<span class="ot">=</span><span class="fu">gibbsC</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.9</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1000</span>)</span>
<span id="cb150-29"><a href="#cb150-29" aria-hidden="true" tabindex="-1"></a>mychainC<span class="ot">=</span><span class="fu">as.data.frame</span>(mychainC)</span>
<span id="cb150-30"><a href="#cb150-30" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mychainC) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;x&#39;</span>,<span class="st">&#39;y&#39;</span>)</span></code></pre></div>
<p>And here is the result of comparison:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NOW WE MAKE QQPLOT:</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="co"># qqplot of x_t vs x_t:</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>xt_r <span class="ot">=</span> my_chainR<span class="sc">$</span>X</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>xt_c <span class="ot">=</span> mychainC<span class="sc">$</span>x</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(xt_r,xt_c)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># qqplot of y_t vs y_t:</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>yt_r <span class="ot">=</span> my_chainR<span class="sc">$</span>Y</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>yt_c <span class="ot">=</span> mychainC<span class="sc">$</span>y</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(yt_r,yt_c)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong>Exercise &lt;3&gt;:</strong><br />
&lt;3&gt; Compare the computation time of the two functions with the
function “microbenchmark”.<br />
<strong>Solution:</strong></p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: package &#39;microbenchmark&#39; was built under R version 4.2.2</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="st">&#39;with Pure R&#39;</span><span class="ot">=</span><span class="fu">my_gibbs_xy_r</span>(mu, sigma, rho, <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), N),</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&#39;with Rcpp&#39;</span><span class="ot">=</span><span class="fu">gibbsC</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.9</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>))</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##          expr       lq    median        uq
## 1 with Pure R 4042.001 4680.3010 5874.0010
## 2   with Rcpp   28.551   37.3515   53.0015</code></pre>
<p>From this coputation time comparisom above we can see that computing
with Rcpp is significantly faster.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all at the end:</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
