<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="22062" />


<title>intro</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">intro</h1>
<h4 class="author">22062</h4>
<h4 class="date">2022/10/27</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>StatComp22062 is a simple R package developed to include all my
solutions to the homework of this term’s Statistical Computation, and to
reproduce the methods of the Adaptive Best-Subset Selection (ABESS)
algorithm according to its thesis, A polynomial algorithm for
best-subset selection problem. The ABESS algorithm is an polynomial
algorithm for solving the problem of best-subset selection based on a
splicing technique and an information criterion. It actually already has
an official package, and I am only reproducing the algorithm with my own
written code, so it is very likely that the performance of my package
falls far behind the official package. In this package, the ‘myABESS’
function is used to gain the wanted sparse coefficient vector once the
largest support size we allow is given. And it does this through the
BessFix function which gives the result when the support size is fixed.
The splicing method is proposed in the ‘Spliing’ function. These
functions can help us find the true sparsity level and the corresponding
best-subset.</p>
</div>
<div id="source-codes-for-the-algorithm" class="section level2">
<h2>Source Codes for the algorithm</h2>
<div id="the-l2normsq-and-matmultc-function" class="section level3">
<h3>the l2NormSq and matmultC function</h3>
<p>The l2NormSq and matmultC functions compute the square of l2 norm of
vectors and the result of matrix multiplication respectively. The
matmultC function is coded in cpp to make the matrix multiplication
faster. Their source codes are as follows.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>l2NormSq <span class="ot">=</span> <span class="cf">function</span>(b){</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( <span class="fu">crossprod</span>(b,b)[<span class="dv">1</span>,<span class="dv">1</span>] )</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;Rcpp.h&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> Rcpp<span class="op">;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">// [[Rcpp::export]]</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>NumericMatrix matmultC<span class="op">(</span>NumericMatrix matA<span class="op">,</span> NumericMatrix matB<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> m <span class="op">=</span> matA<span class="op">.</span>nrow<span class="op">(),</span> n <span class="op">=</span> matA<span class="op">.</span>ncol<span class="op">(),</span> p <span class="op">=</span> matB<span class="op">.</span>ncol<span class="op">();</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">double</span> stemp <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  NumericMatrix matC<span class="op">(</span>m<span class="op">,</span> p<span class="op">);</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i<span class="op">=</span><span class="dv">0</span><span class="op">;</span>i<span class="op">&lt;</span>m<span class="op">;++</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> k<span class="op">=</span><span class="dv">0</span><span class="op">;</span>k<span class="op">&lt;</span>n<span class="op">;++</span>k<span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>      stemp <span class="op">=</span> matA<span class="op">(</span>i<span class="op">,</span>k<span class="op">);</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> j<span class="op">=</span><span class="dv">0</span><span class="op">;</span>j<span class="op">&lt;</span>p<span class="op">;++</span>j<span class="op">){</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>        matC<span class="op">(</span>i<span class="op">,</span>j<span class="op">)</span> <span class="op">+=</span> stemp<span class="op">*</span>matB<span class="op">(</span>k<span class="op">,</span>j<span class="op">);</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>      <span class="op">}</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span><span class="op">(</span>matC<span class="op">);</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="the-splicing-function" class="section level3">
<h3>the Splicing function</h3>
<p>This function works for a condition with fixed initial active set and
is trying to solve the constraint minimization problem: <span class="math display">\[min_{\beta} L_{n} \left ( \beta \right
),  s.t    {||\beta ||}_{0}\le s \]</span> where <span class="math display">\[ L_{n} \left ( \mathbf{\beta}  \right
)=\frac{1}{2n}||\mathbf{y}-\mathbf{X}\mathbf{\beta}
||_{2}^{2}  \]</span> To determine which variables are important, we
define the active set for a given k: <span class="math display">\[A_k=\left \{ j\in A:\sum I(\xi_j \ge \xi_i)\le k
\right \} \]</span> Then, we iteratively update the active set for any
splicing size k that is no larger than s, based on the Backward
sacrifice(the signifance of variable j in the active set, defined by the
loss of discarding it) and the Forward sacrifice(the signifance of
variable j in the non-active set, defined by the gain of adding it to
the active set). The updating iteration is stopped when the loss
function cannot be improved by further splicing.</p>
<p>The source code for the splicing algorithm is as follows:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>Splicing <span class="ot">=</span> <span class="cf">function</span>(beta, d, setA, setI, kmax, TAWs,    n,p,x,y){</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  sizeA<span class="ot">=</span><span class="fu">length</span>(setA)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  sizeI<span class="ot">=</span><span class="fu">length</span>(setI)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">=</span><span class="fu">as.matrix</span>(x)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">=</span> <span class="fu">as.matrix</span>(beta)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  L0<span class="ot">=</span>L<span class="ot">=</span> <span class="fu">l2NormSq</span>( y <span class="sc">-</span> <span class="fu">matmultC</span>(x,beta))<span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>n</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  SacBack<span class="ot">=</span>SacFort<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>p) {</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    xj<span class="ot">=</span>x[,j]</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    temp <span class="ot">=</span> (<span class="fu">t</span>(xj)<span class="sc">%*%</span>xj)[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    SacBack<span class="ot">=</span><span class="fu">c</span>(SacBack,temp<span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>n<span class="sc">*</span>beta[j]<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    SacFort<span class="ot">=</span><span class="fu">c</span>(SacFort,temp<span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>n<span class="sc">*</span>(d[j]<span class="sc">/</span>temp<span class="sc">*</span>n)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>kmax) {</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    setAk<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> setA) {</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>( <span class="fu">sum</span>( SacBack[j]<span class="sc">&gt;=</span>SacBack[setA] )<span class="sc">&lt;=</span>k ){</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>        setAk<span class="ot">=</span><span class="fu">c</span>(setAk,j)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    setIk<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> setI) {</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>( <span class="fu">sum</span>( SacFort[j]<span class="sc">&lt;=</span>SacFort[setI] )<span class="sc">&lt;=</span>k ){</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>        setIk<span class="ot">=</span><span class="fu">c</span>(setIk,j)</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    setAk_wav<span class="ot">=</span> <span class="fu">union</span>(<span class="fu">setdiff</span>(setA,setAk),setIk)</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    setIk_wav<span class="ot">=</span> <span class="fu">union</span>(<span class="fu">setdiff</span>(setI,setIk),setAk)</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>    beta_wav<span class="ot">=</span><span class="fu">as.matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>,p))</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    xak_wav<span class="ot">=</span><span class="fu">as.matrix</span>(x[,setAk_wav])</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    beta_wav[setAk_wav]<span class="ot">=</span> <span class="fu">matmultC</span>(<span class="fu">matmultC</span>(<span class="fu">solve</span>( <span class="fu">matmultC</span>(<span class="fu">t</span>(xak_wav),xak_wav) ),<span class="fu">t</span>(xak_wav)),y)</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    beta_wav[setIk_wav]<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>    d_wav<span class="ot">=</span> <span class="fu">matmultC</span>(<span class="fu">t</span>(x), ( y <span class="sc">-</span> <span class="fu">matmultC</span>(x, beta_wav)  ) )<span class="sc">/</span>n</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>    Lnbeta_wav <span class="ot">=</span> <span class="fu">l2NormSq</span>( y <span class="sc">-</span> <span class="fu">matmultC</span>(x, beta_wav)  )<span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>n</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>( L<span class="sc">&gt;</span>Lnbeta_wav ){</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>      beta_hat<span class="ot">=</span>beta_wav</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>      d_hat<span class="ot">=</span>d_wav</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>      setA_hat<span class="ot">=</span>setAk_wav</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>      setI_hat<span class="ot">=</span>setIk_wav</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>      L<span class="ot">=</span>Lnbeta_wav</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( L0<span class="sc">-</span>L<span class="sc">&lt;</span>TAWs ){</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>    beta_hat<span class="ot">=</span>beta</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>    d_hat<span class="ot">=</span>d</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>    setA_hat<span class="ot">=</span>setA</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>    setI_hat<span class="ot">=</span>setI    </span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( <span class="fu">list</span>( <span class="st">&quot;bet&quot;</span><span class="ot">=</span>beta_hat[,<span class="dv">1</span>],<span class="st">&quot;d&quot;</span><span class="ot">=</span>d_hat,<span class="st">&quot;A&quot;</span><span class="ot">=</span>setA_hat,<span class="st">&quot;I&quot;</span><span class="ot">=</span>setI_hat  ,<span class="st">&quot;L&quot;</span><span class="ot">=</span>L ) )</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="the-abess-and-bessfix-function" class="section level3">
<h3>the Abess and BessFix function</h3>
<p>To determine what might be the best possible choice for the
supporting size, we use a criterion denoted as SIC for an active set A:
<span class="math display">\[SIC(A)=nlogL_{A} +|A|log(p)loglogn\]</span>
where <span class="math display">\[L_{A} =min_{ \beta _{I} =0 }
L_n(\beta ),I=A^{c} \]</span> so we can use this criterion to find the
true support size.<br />
And given a fixed support size s, BessFixed is used to perform
best-subset selection.<br />
Their source codes are as follows.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>BessFix <span class="ot">=</span> <span class="cf">function</span>(s,x,y,kmax,TAWs,   n,p,corrsY){</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  setA <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>p) {</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>( <span class="fu">sum</span>( corrsY[j]<span class="sc">&lt;=</span>corrsY ) <span class="sc">&lt;=</span> s   ){</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>      setA <span class="ot">=</span> <span class="fu">c</span>(setA,j)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  setI <span class="ot">=</span> <span class="fu">setdiff</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>p),setA)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">as.matrix</span>(x)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  beta<span class="ot">=</span>d<span class="ot">=</span><span class="fu">as.matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>,p))</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  xA <span class="ot">=</span> <span class="fu">as.matrix</span>(x[,setA])</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  xI <span class="ot">=</span> <span class="fu">as.matrix</span>(x[,setI])</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  beta[setA] <span class="ot">=</span> (<span class="fu">matmultC</span>(<span class="fu">matmultC</span>((<span class="fu">solve</span>(  <span class="fu">matmultC</span>(<span class="fu">t</span>(xA),xA))  ) , <span class="fu">t</span>(xA)) , y ) )[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  d[setI] <span class="ot">=</span> ( <span class="fu">matmultC</span>( <span class="fu">t</span>(xI),(y<span class="sc">-</span><span class="fu">matmultC</span>(x,beta)) ) )[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">/</span>n</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (<span class="dv">1</span>) {</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    news <span class="ot">=</span> <span class="fu">Splicing</span>(<span class="at">beta=</span>beta,<span class="at">d=</span>d,<span class="at">setA =</span> setA,<span class="at">setI =</span> setI,<span class="at">kmax=</span>kmax,<span class="at">TAWs =</span> TAWs,   n,p,x,y)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    beta1 <span class="ot">=</span> news[[<span class="dv">1</span>]]</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    d1<span class="ot">=</span>news[[<span class="dv">2</span>]]</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    setA1<span class="ot">=</span>news[[<span class="dv">3</span>]]</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    setI1<span class="ot">=</span>news[[<span class="dv">4</span>]]</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    L1<span class="ot">=</span>news[[<span class="dv">5</span>]]</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>( <span class="fu">setequal</span>(setA1,setA) <span class="sc">&amp;</span> <span class="fu">setequal</span>(setI1,setI) ){</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>{</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>      beta <span class="ot">=</span> beta1</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>      d <span class="ot">=</span> d1</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>      setA <span class="ot">=</span> setA1</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>      setI <span class="ot">=</span> setI1</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(  <span class="fu">list</span>(<span class="st">&quot;bet&quot;</span><span class="ot">=</span>beta1,<span class="st">&quot;d&quot;</span><span class="ot">=</span>d1,<span class="st">&quot;A&quot;</span><span class="ot">=</span>setA1,<span class="st">&quot;I&quot;</span><span class="ot">=</span>setI1,  <span class="st">&quot;L&quot;</span><span class="ot">=</span>L1) )</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>myABESS <span class="ot">=</span> <span class="cf">function</span>(x,y,n,p, </span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>                   <span class="at">smax=</span><span class="fu">min</span>(p,<span class="fu">floor</span>( n<span class="sc">/</span><span class="fu">log</span>(p)<span class="sc">/</span><span class="fu">log</span>(<span class="fu">log</span>(n)) ) )</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>                   ){</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>  corrsY<span class="ot">=</span><span class="fu">vector</span>(<span class="at">length =</span> p)</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>p) {</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>    xi<span class="ot">=</span>x[,i]</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>    corrsY[i] <span class="ot">=</span> <span class="fu">abs</span>( <span class="fu">crossprod</span>(xi,y)[<span class="dv">1</span>,<span class="dv">1</span>] )<span class="sc">/</span><span class="fu">sqrt</span>( <span class="fu">crossprod</span>(xi,xi)[<span class="dv">1</span>,<span class="dv">1</span>] )</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">=</span> <span class="fu">vector</span>(<span class="at">mode=</span><span class="st">&quot;list&quot;</span>,<span class="at">length =</span> smax)</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>  SIC <span class="ot">=</span> Ls <span class="ot">=</span> <span class="fu">vector</span>(<span class="at">length =</span> smax)</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>smax) {</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>    taws<span class="ot">=</span><span class="fl">1e-2</span><span class="sc">*</span>s<span class="sc">*</span><span class="fu">log</span>(p)<span class="sc">*</span><span class="fu">log</span>(<span class="fu">log</span>(n))<span class="sc">/</span>n</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>    kmax <span class="ot">=</span> s</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>    data[[s]] <span class="ot">=</span> <span class="fu">BessFix</span>(<span class="at">s =</span> s, <span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">kmax =</span> kmax, <span class="at">TAWs =</span> taws, <span class="at">n =</span> n, <span class="at">p =</span> p,<span class="at">corrsY =</span> corrsY)</span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>    Ls[s] <span class="ot">=</span> (data[[s]])[[<span class="dv">5</span>]]</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>    SIC[s] <span class="ot">=</span> n<span class="sc">*</span><span class="fu">log</span>(Ls[s]) <span class="sc">+</span> <span class="fu">length</span>( (data[[s]])[[<span class="dv">3</span>]] )<span class="sc">*</span><span class="fu">log</span>(p)<span class="sc">*</span><span class="fu">log</span>(<span class="fu">log</span>(n))</span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>  best_s <span class="ot">=</span> <span class="fu">which.min</span>(SIC)</span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( <span class="fu">list</span>( <span class="st">&quot;result&quot;</span><span class="ot">=</span>data[[ best_s ]], <span class="st">&quot;SIC&quot;</span><span class="ot">=</span>SIC, <span class="st">&quot;BestSize&quot;</span><span class="ot">=</span>best_s  ) )</span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="an-illustration" class="section level2">
<h2>An Illustration</h2>
<p>The following is an illustration of how the functions are used and
their performance. The number of observations is set to be n=60, and the
dimension of the coefficient vector is set to p=20. As we can see in the
following chunk, the coefficient vector is a sparse vector with only few
non-zero values as its support set. Now we generate predictors and
responses in the following manner:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>seed<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(seed)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">60</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>eps_sig<span class="ot">=</span><span class="dv">1</span>   <span class="co"># for epsilon</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">=</span> <span class="fu">c</span>(<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>        <span class="dv">18</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">14</span>,<span class="dv">0</span>,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rep</span>(<span class="dv">0</span>,p<span class="dv">-10</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>sig<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>p,<span class="at">ncol=</span>p)  <span class="co"># matrix, for X the matrix</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>sig<span class="ot">=</span> <span class="fl">0.5</span><span class="sc">^</span>( <span class="fu">abs</span>( <span class="fu">row</span>(sig)<span class="sc">-</span><span class="fu">col</span>(sig) ) )</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">rmvnorm</span>(n,<span class="at">mean=</span><span class="fu">rep</span>(<span class="dv">0</span>,p),<span class="at">sigma=</span>sig)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">scale</span>(x,<span class="at">center =</span> T,<span class="at">scale =</span> F)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">rnorm</span>(n, <span class="at">mean=</span>x <span class="sc">%*%</span> beta, eps_sig)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">as.matrix</span>(x)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">as.matrix</span>(y)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>syn_sim_data <span class="ot">=</span> <span class="fu">list</span>( <span class="st">&quot;x&quot;</span><span class="ot">=</span>x,<span class="st">&quot;y&quot;</span><span class="ot">=</span>y,<span class="st">&quot;beta&quot;</span><span class="ot">=</span>beta )</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">cbind.data.frame</span>(<span class="st">&quot;y&quot;</span> <span class="ot">=</span> syn_sim_data[[<span class="st">&quot;y&quot;</span>]],</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>                        syn_sim_data[[<span class="st">&quot;x&quot;</span>]])</span></code></pre></div>
<p>The following is the result of the implemented abess algorithm. The
estimated cofficients are presented as beta, the active set as A (with
inactive set as I), and they are consistant with the initial cofficients
we set earlier, along with the best support size. The performance of the
implemented method is quite precise compared to the real value.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>res<span class="ot">=</span><span class="fu">myABESS</span>(x,y,n,p,<span class="at">smax =</span> p<span class="dv">-1</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>result[<span class="sc">-</span><span class="dv">2</span>]  <span class="co"># hide d;</span></span></code></pre></div>
<pre><code>## $bet
##  [1] 15.96132  0.00000  0.00000  0.00000  0.00000 18.00448  0.00000  0.00000
##  [9] 14.04079  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000
## [17]  0.00000  0.00000  0.00000  0.00000
## 
## $A
## [1] 6 9 1
## 
## $I
##  [1]  2  3  4  5  7  8 10 11 13 14 16 17 18 19 20 12 15
## 
## $L
## [1] 0.502048</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Best size: &quot;</span>,res<span class="sc">$</span>BestSize))</span></code></pre></div>
<pre><code>## [1] &quot;Best size:  3&quot;</code></pre>
</div>
<div id="comparison-with-the-official-package" class="section level2">
<h2>Comparison with the official package</h2>
<p>The following is a runtime comparison on my reproduced package and
the official package for abess algorithm. Not only does the official
package have far more functions and choices for the algorithm, but only
it runs much faster. It is obvious from the benchmark comparison that
the official package has far better performance in its speed.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(abess)</span></code></pre></div>
<pre><code>## Warning: package &#39;abess&#39; was built under R version 4.2.2</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="st">&#39;with my package&#39;</span><span class="ot">=</span><span class="fu">myABESS</span>(x,y,n,p,<span class="at">smax =</span> p<span class="dv">-1</span>),</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&#39;with Official package&#39;</span><span class="ot">=</span><span class="fu">abess</span>(x,y,<span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##                    expr         lq     median         uq
## 1       with my package 114.260502 116.533801 121.894401
## 2 with Official package   2.078851   2.174501   2.311852</code></pre>
<p>And possible reasons for this huge difference may include that the
official package is written in a larger proportion of rcpp instead of R
while only very limited parts of my package used the same way to reduce
runtime. Also too much use of list and some unnecessary
calculations(like calculating both sacrifices for all number between 1
and p) makes the functions slower.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all at the end:</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
